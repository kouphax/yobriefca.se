<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Yo Briefcase!]]></title>
  <link href="http://yobriefca.se/feed/index.html" rel="self"/>
  <link href="http://yobriefca.se/"/>
  <updated>2012-10-06T10:26:40+01:00</updated>
  <id>http://yobriefca.se/</id>
  <author>
    <name><![CDATA[James Hughes]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Learning Resources for Scala, Play! and Mongo]]></title>
    <link href="http://yobriefca.se/blog/2012/10/06/learning-resources-for-scala/"/>
    <updated>2012-10-06T10:17:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/10/06/learning-resources-for-scala</id>
    <content type="html"><![CDATA[<p>I&#8217;ve been asked a lot recently for some resources on various technologies, namely Scala, Play! (2.0) and Mongo so I thought I&#8217;d share the wealth (so to speak).</p>

<p>Got any good resources that I haven&#8217;t listed here?  Let me know.</p>

<h2>Scala</h2>

<ul>
<li><a href="http://www.scala-lang.org/">Official Site</a></li>
<li><a href="https://vimeo.com/40255430">Screencast</a></li>
<li><a href="http://www.scala-lang.org/node/1305">Various Links from the official site</a></li>
<li><a href="http://scalatron.github.com/">Scalatron</a> - learn Scala by programming a game</li>
<li><a href="http://twitter.github.com/scala_school/">Scala School</a> - Twitters learning resource</li>
<li><a href="http://typesafe.com/resources/book/scala-for-the-impatient">Scala for the Impatient</a> - excellent &#8220;lite&#8221; version of a great book.</li>
<li><a href="http://typesafe.com/resources/videos">Scala Videos</a></li>
<li><a href="https://www.coursera.org/course/progfun">Coursera Course</a> - Scala course on Coursera by Martin Odersky. Only good for five weeks or so but during that time anyone can sign up and download the video lectures and materials.</li>
</ul>


<h2>Play!</h2>

<ul>
<li><a href="http://www.playframework.org/">Official Site</a></li>
<li><a href="http://www.playframework.org/documentation/2.0.3/ScalaHome">Official Docs</a> - Excellent resource</li>
<li><a href="https://github.com/playframework/Play20/tree/master/samples/scala">Scala Code Samples</a> - Some nice examples from the official Github repo.</li>
<li><a href="http://yobriefca.se/blog/2012/05/08/starter-for-10-scala/">Scala, Play! and Mongo</a> - Blog post on writing a simple app using all those technologies.</li>
<li><a href="http://www.artima.com/articles/play2_scala_squeryl.html">Getting Started with Play! 2, Scala and Squeryl</a></li>
<li><a href="http://www.jamesward.com/2012/02/21/play-framework-2-with-scala-anorm-json-coffeescript-jquery-heroku">Play! 2 Getting Started</a></li>
</ul>


<h2>Mongo</h2>

<ul>
<li><a href="http://www.mongodb.org/">Official Website</a></li>
<li><a href="http://try.mongodb.org/">Try Mongo</a> - A Tiny MongoDB Browser Shell (mini tutorial included)</li>
<li><a href="http://openmymind.net/mongodb.pdf">Little Book of Mongo</a> (<a href="http://openmymind.net/mongodb.epub">epub</a>) - Book about Mongo</li>
<li><a href="http://mongly.com/">Mongly</a> - Various tutorials and essays on MongoDB</li>
<li><a href="https://speakerdeck.com/u/kouphax/p/mongodb">Presentation</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[StackMob Lightning Talk]]></title>
    <link href="http://yobriefca.se/blog/2012/09/13/stackmob-lightning-talk/"/>
    <updated>2012-09-13T20:33:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/09/13/stackmob-lightning-talk</id>
    <content type="html"><![CDATA[<p>So I finally found an opportunity to deliver a quick lightning talk on <a href="http://stackmob.com">StackMob</a> at our
monthly CodeSlice sessions in work.  Knocked it up today over lunch and presented it tonight.  Would like to
pull this one out into a more in depth and interactive look&#8230; just waiting for someone to ask :)</p>

<h2>Video</h2>

<iframe src="http://player.vimeo.com/video/49405807?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff" width="500" height="375" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>


<h2>Slides</h2>

<script async class="speakerdeck-embed" data-id="5051d07ffe08c30002031d18" data-ratio="1.3333333333333333" src="http://yobriefca.se//speakerdeck.com/assets/embed.js"></script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Securely Serving Static Files on Heroku]]></title>
    <link href="http://yobriefca.se/blog/2012/08/21/securely-serving-static-files-on-heroku/"/>
    <updated>2012-08-21T21:00:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/08/21/securely-serving-static-files-on-heroku</id>
    <content type="html"><![CDATA[<p>More than once I&#8217;ve had a need to host what is essentially static content on Heroku.  For example when building a simple internal web app for my company that used an existing API or Parse.  Invariably in this situation I have also needed to secure this app - nothing to drastic, no need for multiple user accounts or roles or any such nonsense (we generally run our non-essential systems on the honour system).  Basic auth is more than enough.</p>

<p>So, static content plus basic auth.  Heroku itself doesn&#8217;t offer basic auth as an option (why would it?) and so you&#8217;d need to roll it into your app.  Once I hosted my static stuff inside a Scala/Play! app, once a Sinatra app and the other a Rails app - variety is the spice of life.  But each time I did it I felt a little dirty - it was noticeably slower serving this content from within an app and it seemed rather wasteful.  So, in a bid to stamp out technical debt, I&#8217;ve ripped out all those web frameworks an replaced them with good old Apache.</p>

<p>Now anyone with any knowledge of Apache will already be able to deduce the steps required here - but I want to note it for posterity, for myself, when I forget, in about a week.</p>

<h2>BuildPack</h2>

<p>First things first you&#8217;ll want to get your hands on a custom <a href="https://devcenter.heroku.com/articles/buildpacks">Heroku BuildPack</a> - these are the things that prepare your app instance with all the software and support it needs to run.</p>

<p>I recommend you fork and clone the <a href="https://github.com/pearkes/heroku-buildpack-static">heroku-buildpack-static</a> buildpack available from pearkes on GitHub.</p>

<h2>.htpassword</h2>

<p>Next you need to generate your <code>.htpasswd</code> file that will serve as your store for your Basic Auth credentials.  The two simplest ways to generate one of these is to either use <a href="http://www.htaccesstools.com/htpasswd-generator/">htaccesstools.com&#8217;s htpasswd generator</a> or generate on via the command line.</p>

<p>The simplest command to generate one is this,</p>

<pre><code>htpasswd -cb &lt;password_file&gt; &lt;username&gt; &lt;password&gt;
</code></pre>

<p>For example,</p>

<pre><code>htpasswd -cb .htpasswd james password
</code></pre>

<p>Will generate a file in the current directory called .htpasswd (the standard name for these files) with a single entry of username = james and password = password.</p>

<h2>Updating the BuildPack</h2>

<p>Either run the above command in the <code>heroku-buildpack-static/conf</code> folder or move your <code>.htpasswd</code> file into the that folder.</p>

<p>Next up you want to configure apache to authenticate against that generate password file.  Adding the following lines to the <code>httpd.conf</code> file in the <code>heroku-buildpack-static/conf</code> will lock all assets under your apps site down,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='apache'><span class='line'>    <span class="nb">AuthType</span>      Basic
</span><span class='line'>    <span class="nb">AuthName</span>      <span class="s2">&quot;Authentication Required&quot;</span>
</span><span class='line'>    <span class="nb">AuthUserFile</span>  <span class="s2">&quot;/app/apache/conf/.htpasswd&quot;</span>
</span><span class='line'>    <span class="nb">Require</span>       valid-user
</span></code></pre></td></tr></table></div></figure>


<p>This block should be added to the configuration section starting <code>&lt;Directory /&gt;</code> i.e.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='apache'><span class='line'>  <span class="nt">&lt;Directory</span> <span class="s">/</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nb">Options</span> FollowSymLinks
</span><span class='line'>      <span class="nb">AllowOverride</span> <span class="k">None</span>
</span><span class='line'>
</span><span class='line'>      <span class="nb">AuthType</span>      Basic
</span><span class='line'>      <span class="nb">AuthName</span>      <span class="s2">&quot;Authentication Required&quot;</span>
</span><span class='line'>      <span class="nb">AuthUserFile</span>  <span class="s2">&quot;/app/apache/conf/.htpasswd&quot;</span>
</span><span class='line'>      <span class="nb">Require</span>       valid-user
</span><span class='line'>
</span><span class='line'>      <span class="nb">Order</span> deny,allow
</span><span class='line'>      <span class="nb">Deny</span> from <span class="k">all</span>
</span><span class='line'>  <span class="nt">&lt;/Directory&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You&#8217;ll notice the <code>AuthUserFile</code> points to the correct absolute path for our custom .htpasswd file.  If you called it anything else please update this line accordingly.</p>

<p>Commit and push that to your forked repo.</p>

<h2>Using the BuildPack</h2>

<p>Finally we need to tell Heroku to use the custom buildpack.  If you have yet to create an app then you can specify the buildpack during creation,</p>

<pre><code>heroku create &lt;app name&gt; --buildpack &lt;url to your repo&gt;
</code></pre>

<p>If you have created you app already you can add the buildpack through an additional config setting</p>

<pre><code>heroku config:add BUILDPACK_URL=&lt;url to your repo&gt;
</code></pre>

<p>Push your new or updated site to Heroku and watch in awe as your site is that bit more secure.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dependencies in JavaScript: Constructor, Setter or Global]]></title>
    <link href="http://yobriefca.se/blog/2012/08/21/dependencies-in-javascript-constructor/"/>
    <updated>2012-08-21T07:59:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/08/21/dependencies-in-javascript-constructor</id>
    <content type="html"><![CDATA[<p>There has been an interesting conversation on Twitter over the last number of hours between @derickbailey and a number of other people and it all started with this tweet,</p>

<blockquote class="twitter-tweet tw-align-center"><p>anyone have links to articles on why setter injection is evil? /cc <a href="https://twitter.com/jbogard"><s>@</s><b>jbogard</b></a> <a href="https://twitter.com/jeremydmiller"><s>@</s><b>jeremydmiller</b></a> <a href="https://twitter.com/jflanagan"><s>@</s><b>jflanagan</b></a> <a href="https://twitter.com/chadmyers"><s>@</s><b>chadmyers</b></a></p>&mdash; derickbailey (@derickbailey) <a href="https://twitter.com/derickbailey/status/237658824163614720" data-datetime="2012-08-20T21:14:13+00:00">August 20, 2012</a></blockquote>


<script src="http://yobriefca.se//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>The conversation has been around using DI and IoC in JavaScript (yes I know they are not one in the same, and I know a Container is not a necessary part of DI or IoC thank you very much).  Simple answer is this - good patterns have a place in any language provided they aren&#8217;t abused mercilessly.  But lets get back to the discussion - why would you use constructor injection over setter injection?  Is setter injection evil?  Obviously no strategy is actually evil per-say - just used in the wrong place at the wrong time. So lets go back to the first question - constructor injection vs. setter injection.</p>

<h2>Constructor Injection or Setter Injection</h2>

<p>The simplest answer to this was one I gave @derickbailey earlier,</p>

<blockquote class="twitter-tweet tw-align-center" data-in-reply-to="237664796298854401"><p><a href="https://twitter.com/derickbailey"><s>@</s><b>derickbailey</b></a> resolve mandatory dependenciesvia constructor injection, optional dependencies via setter.  This is a common convention.</p>&mdash; James Hughes (@kouphax) <a href="https://twitter.com/kouphax/status/237792703826522112" data-datetime="2012-08-21T06:06:13+00:00">August 21, 2012</a></blockquote>


<script src="http://yobriefca.se//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>This little bit of knowledge I&#8217;ve had since living down in the guts of Spring MVC about 5 years ago and it makes a lot of sense regardless of how those dependencies are getting in there.</p>

<h2>Fail Early</h2>

<p>When your code goes into an invalid state you want to fail as quickly as possible, this makes debugging much easier and prevents an avalanche of unexpected behaviour.  Using constructor injection (and asserting the existence of dependencies) gives you this ability.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="kd">var</span> <span class="nx">MyThingy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">requiredA</span><span class="p">,</span> <span class="nx">requiredB</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">requiredA</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>  
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">requiredB</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>
</span><span class='line'>      
</span><span class='line'>      <span class="c1">// rest of my code</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">doAThing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span><span class="p">.</span><span class="nx">magic</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span><span class="p">.</span><span class="nx">beepboop</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">var</span> <span class="nx">thing</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyThing</span><span class="p">();</span> <span class="c1">// FAIL FAIL FAIL</span>
</span><span class='line'>  <span class="nx">thing</span><span class="p">.</span><span class="nx">doAThing</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you tried to achieve the same thing with setter injection you would be failing much later in the proceedings,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="kd">var</span> <span class="nx">MyThingy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRequiredA</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">requiredA</span><span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span> <span class="o">=</span> <span class="nx">requiredA</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRequiredB</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">requiredB</span><span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span> <span class="o">=</span> <span class="nx">requiredB</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">doAThing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>   
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>
</span><span class='line'>      
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span><span class="p">.</span><span class="nx">magic</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span><span class="p">.</span><span class="nx">beepboop</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">thing</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyThing</span><span class="p">();</span>
</span><span class='line'>  <span class="nx">thing</span><span class="p">.</span><span class="nx">doAThing</span><span class="p">();</span> <span class="c1">// FAIL FAIL FAIL</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now imagine that the last two lines are miles apart in code-lines, you&#8217;ve gone and lost all context when debugging.  Sure in this trivial example it would be fairly easy to resolve this but if you&#8217;ve gone and lost the plot and created a heavily nested object graph you&#8217;ll be crying before they day is out.</p>

<p>Now setter injection does have it&#8217;s place - for <strong>optional</strong> dependencies,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="kd">var</span> <span class="nx">MyThingy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">requiredA</span><span class="p">,</span> <span class="nx">requiredB</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">requiredA</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>  
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">requiredB</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>
</span><span class='line'>      
</span><span class='line'>      <span class="c1">// rest of my code</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setOptionalC</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">optionalC</span><span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">optionalC</span> <span class="o">=</span> <span class="nx">optionalC</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">doAThing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">optionalC</span><span class="p">)</span> <span class="nx">optionalC</span><span class="p">(</span><span class="s2">&quot;doing a thing...&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span><span class="p">.</span><span class="nx">magic</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span><span class="p">.</span><span class="nx">beepboop</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">var</span> <span class="nx">thing</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyThing</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">thing</span><span class="p">.</span><span class="nx">setOptionalC</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">});</span>
</span><span class='line'>  <span class="nx">thing</span><span class="p">.</span><span class="nx">doAThing</span><span class="p">();</span> <span class="c1">// logs &quot;doing a thing...&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>So the extension of the rule is that</p>

<blockquote><p>Anything injected via <strong>setter injection</strong> needs to be either defaulted initially or checked for existence before use.</p></blockquote>

<h2>Readability</h2>

<p>By following this convention, heck by following any agreed convention, you get better visibility of the expected behaviour of your code.  You know what the object needs to get the job done.  That feels like a poor argument but I think it still warrants a mention here.</p>

<h2>Over Engineering and Deep Graphs</h2>

<p>Obviously if you&#8217;ve over-designed your classes or it has grown out of control this approach becomes difficult to manage.  I&#8217;ve seen something akin to this in some projects,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CoordinatorOfAllTheThings</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">....)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Someone has decided to make every bit of functionality it&#8217;s own little class or module and so the dependency graph has become incredibly broad.  In fact this might suggest they are creating a deep graph as well and simply passing the dependencies down the chain.  <strong>If you have a lot of dependencies then there is something wrong with the object you are creating</strong>.</p>

<p>For fine grained, inter-object communication dependency injection is fine but when you are scaling up to more coarse, inter-module or component communication an evented or message based approach is almost always a better option.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="c1">// rest of previous code</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">doAThing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="nx">EventStream</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;doneathing&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">var</span> <span class="nx">EventStream</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">trigger</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="cm">/* ... */</span> <span class="p">}</span>
</span><span class='line'>      <span class="nx">on</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">var</span> <span class="nx">OtherThing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">requiredD</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">EventStream</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;doneathing&quot;</span><span class="p">,</span> <span class="nx">requiredD</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">var</span> <span class="nx">thing</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyThingy</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">other</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OtherThing</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;stuff done&quot;</span><span class="p">);</span> <span class="p">});</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">thing</span><span class="p">.</span><span class="nx">doAThing</span><span class="p">();</span> <span class="c1">// logs &quot;stuff done&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is a rather contrived example but it should server a point.</p>

<h3>The Global Issue</h3>

<p>You&#8217;ll notice the EventStream object in the code above is global, you&#8217;ll also notice I have skipped part of this posts title  (&#8230; or Global).  Lets come to that now.  It is possible to achieve the same results as constructor/setter injection using global scope,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="kd">var</span> <span class="nx">MyThingy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">global</span><span class="p">.</span><span class="nx">requiredA</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>    
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">global</span><span class="p">.</span><span class="nx">requiredB</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;Missing Dependency&quot;</span>
</span><span class='line'>      
</span><span class='line'>      <span class="c1">// rest of my code</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">doAThing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">global</span><span class="p">.</span><span class="nx">requiredA</span><span class="p">.</span><span class="nx">magic</span><span class="p">()</span> <span class="o">+</span> <span class="nx">global</span><span class="p">.</span><span class="nx">requiredB</span><span class="p">.</span><span class="nx">beepboop</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">var</span> <span class="nx">thing</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyThing</span><span class="p">();</span> <span class="c1">// FAIL FAIL FAIL</span>
</span><span class='line'>  <span class="nx">thing</span><span class="p">.</span><span class="nx">doAThing</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>So rather than inject the necessary dependencies in we are relying on the fact they exist in global scope.  This works fine in some situations.  The EventStream object above is a global hub that can be used throughout the application.  I&#8217;m ok with that.  The risk of global scope is that it&#8217;s easy for objects to be redefined by other actors in your system so existence or behaviour is never guaranteed.  So use sparingly.</p>

<h2>Moptional</h2>

<p>The other alternative approach would be to make everything Moptional.  That is, anything mandatory should be instantiated with a default and provide setter injection for changing default behaviour.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="kd">var</span> <span class="nx">MyThingy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DefaultRequiredA</span><span class="p">();</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DefaultRequiredB</span><span class="p">();</span>
</span><span class='line'>      
</span><span class='line'>      <span class="c1">// rest of my code</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRequiredA</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">requiredA</span><span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span> <span class="o">=</span> <span class="nx">requiredA</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRequiredB</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">requiredB</span><span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span> <span class="o">=</span> <span class="nx">requiredB</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nx">MyThingy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">doAThing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredA</span><span class="p">.</span><span class="nx">magic</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">requiredB</span><span class="p">.</span><span class="nx">beepboop</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">var</span> <span class="nx">thing</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyThing</span><span class="p">();</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">setRequiredB</span><span class="p">(</span><span class="k">new</span> <span class="nx">CustomRequiredB</span><span class="p">())</span>
</span><span class='line'>  <span class="nx">thing</span><span class="p">.</span><span class="nx">doAThing</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>You kind of get the best of worlds here - not having to worry about default behaviour but have the ability to override this (for example in testing).  But then you need to think about this.  Why are you providing this sort of strategy?  Are you simply hiding all implementation for an object but providing setters and getter to simply aid testing?  If that&#8217;s the case - STOP.  Your code should be testable but you should not change your code to simply aid testing.  Perhaps its time to go back and re-think your strategy?  Also, for testing - it&#8217;s entirely possible, given the dynamic nature of JavaScript, to redefine the internal dependencies prior to them being instantiated in your object anyway.  Don&#8217;t add features or behaviour that you don&#8217;t actually need to deliver the solution.</p>

<h2>Wrap Up</h2>

<p>This was playing over and over on my ride into work this morning (I cycle I have a lot of thinking time) and I wanted to get it out there.  Hopefully be useful to people asking some questions on this topic.</p>

<p>Oh and IoC <strong>Containers</strong> in JavaScript&#8230;&#8230; don&#8217;t.</p>

<p>My $0.02</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Backend as a Service - Part One]]></title>
    <link href="http://yobriefca.se/blog/2012/08/08/backend-as-a-service-part-one/"/>
    <updated>2012-08-08T14:10:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/08/08/backend-as-a-service-part-one</id>
    <content type="html"><![CDATA[<p>I recently wrote an article for <a href="http://cloudspring.com/">CloudSpring</a> (a part of the <a href="http://www.sitepoint.com/">SitePoint</a> family) around what you can expect and what you should think about when going for one of the &#8220;Backend as a Service&#8221; offerings on the market.</p>

<p>The article is <a href="http://cloudspring.com/backend-as-a-service-part-1/">now live</a>.</p>

<h3><a href="http://cloudspring.com/backend-as-a-service-part-1/">CloudSpring: Backend as a Service Part 1</a></h3>

<p>Part 2, the one where I look at whats actually out there, will be ready within the next week.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fear of Code]]></title>
    <link href="http://yobriefca.se/blog/2012/08/05/fear-of-code/"/>
    <updated>2012-08-05T20:36:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/08/05/fear-of-code</id>
    <content type="html"><![CDATA[<p>More silly wishy washy nonsense - take what you will.</p>

<p>Recently Thomas Fuchs has this to say on twitter,</p>

<blockquote class="twitter-tweet"><p>As a programmer, you should be afraid of code, and eliminate as much as possible.</p>&mdash; Thomas Fuchs (@thomasfuchs) <a href="https://twitter.com/thomasfuchs/status/230871987881390081" data-datetime="2012-08-02T03:45:45+00:00">August 2, 2012</a></blockquote>


<script src="http://yobriefca.se//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Its great, I love this stuff and it got me thinking and I thought why not put my thoughts up here, right?  After all this is what this place is all about.</p>

<p>Rather than describe the emotion as fear (&#8220;be afraid of code&#8221;) i&#8217;d posit that, as a programmer, you should be respectful of code.  Rather than eliminate as much as possible you should conserve it as much as possible - don&#8217;t write it in the first place.</p>

<p>A while back I posted something similar on Twitter - I can&#8217;t find the tweet right now but it went a little something like this,</p>

<blockquote><p>Adding code is great, removing code is greater but not writing the code in the first place is greatest</p></blockquote>

<p>As a developer it is very easy to fall into the trap of creating some sort of highly reusable complex masterpiece that is going to change the way we write code forever.  But down that road, madness lies.  Desigining too much, adding too many features, creating too many abstractions, handling every single edge case, writing too many tests - all this stuff is just extra complexity, extra code that simply muddies the solution and makes it harder for someone to understand the solution.  More code doesn&#8217;t solve the problem faster, more code doesn&#8217;t make things easier, more code doesn&#8217;t help.</p>

<p>In other words - writing too much code, regardless of quality is just a selfish act.  That goes for 3rd party code too.</p>

<p>Quit it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[expect.kt - Testing Library for Kotlin]]></title>
    <link href="http://yobriefca.se/blog/2012/07/25/expect-dot-kt-testing-library-for-kotlin/"/>
    <updated>2012-07-25T20:31:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/25/expect-dot-kt-testing-library-for-kotlin</id>
    <content type="html"><![CDATA[<p>In a bid to delve into the <a href="http://kotlin.jetbrains.org/">language</a> a bit further than a rake of tiny console apps I decided to do something &#8220;real&#8221; with Kotlin.  With that in mind - welcome <a href="https://github.com/kouphax/expect.kt">expect.kt</a>.</p>

<p>It started purely as a learning venture but I think there is a certain usefulness in the library so its probably worth sharing :).  Now it&#8217;s worth noting that kotlin already has a number of testing statements that you can achieve a lot of this stuff with - this library gives you a few things over and above these statements</p>

<ol>
<li>Alternative syntax.  Testing is quite a personal thing and some people like to write things in different ways.</li>
<li>Descriptive assertions.  Some would say <code>expect(2).toBePositive()</code> reads better than <code>assertTrue(2 &gt; 0)</code> or <code>expect(2 &gt; 0) { true }</code>.  Again its all about taste, and variety is the spice of life.</li>
<li>Chained assertions.  See later</li>
</ol>


<p>Rather than some campaign to replace the inbuilt expectations and assertions this library intended to complement them.</p>

<h2>So what is expect.kt?</h2>

<p>Expect.kt is a set of (growing) assertions/expectations that you can use in your kotlin based tests.  It gives you a number of ways to assert your expectations and gives you quite descriptive methods in which to do it.</p>

<h3>Expect Syntax</h3>

<p>The  expect syntax is the default way to assert things,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">tests</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.junit.Test</span> <span class="n">as</span> <span class="n">test</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">kotlin.expectations.*</span>
</span><span class='line'>
</span><span class='line'><span class="kd">class</span> <span class="nc">StringExpectationTests</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">test</span> <span class="n">fun</span> <span class="nf">testHelloWorld</span> <span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">expect</span><span class="o">(</span><span class="s">&quot;Hello World&quot;</span><span class="o">).</span><span class="na">toStartWith</span><span class="o">(</span><span class="s">&quot;Hell&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Most of that is boilerplate JUnit testy things but the key line is</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">expect</span><span class="o">(</span><span class="s">&quot;Hello World&quot;</span><span class="o">).</span><span class="na">toStartWith</span><span class="o">(</span><span class="s">&quot;Hell&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Reads quite nicely IMHO.</p>

<h3>Should Syntax</h3>

<p>The should syntax offers a more fluent syntax if you want to call it that, if we wanted to write the same test above using the should syntax we could do this,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="s">&quot;Hello World&quot;</span><span class="o">.</span><span class="na">should</span><span class="o">.</span><span class="na">startWith</span><span class="o">(</span><span class="s">&quot;Hell&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So rather than wrap your target with an expect you get and extension function to fluently assert it.</p>

<h3>Chaining</h3>

<p>Sometimes making a single assertion on a result isn&#8217;t enough and rather than write <code>assertTrue(...)</code> multiple times you can use extpect.kt&#8217;s chaining support.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">expect</span><span class="o">(</span><span class="s">&quot;Hello World&quot;</span><span class="o">).</span><span class="na">toStartWith</span><span class="o">(</span><span class="s">&quot;Hell&quot;</span><span class="o">).</span><span class="na">and</span><span class="o">.</span><span class="na">toEndWith</span><span class="o">(</span><span class="s">&quot;rld&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or, with the should syntax,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="s">&quot;Hello World&quot;</span><span class="o">.</span><span class="na">should</span><span class="o">.</span><span class="na">startWith</span><span class="o">(</span><span class="s">&quot;Hell&quot;</span><span class="o">).</span><span class="na">and</span><span class="o">.</span><span class="na">endWith</span><span class="o">(</span><span class="s">&quot;rld&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;s a bit more readable than expect after expect, right?</p>

<p>So thats it for now - there are a number of assertions implemented already on the useful types (Strings, Ints, Doubles, Dates, Booleans for example) and there are more planned on the way.  Currently you&#8217;ll be wanting to build from source (or copy/paste what you need).</p>

<p>Finally - A shout out to .NETs <a href="http://fluentassertions.codeplex.com/">FluentAssertions</a> where a lot of the assertions found their origin!</p>

<p><a href="https://github.com/kouphax/expect.kt">expect.kt</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Kotlin: Nullable Extensions]]></title>
    <link href="http://yobriefca.se/blog/2012/07/18/kotlin-nullable-extensions/"/>
    <updated>2012-07-18T22:26:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/18/kotlin-nullable-extensions</id>
    <content type="html"><![CDATA[<p>Haskell doesn&#8217;t have if statements - that blew my mind the first time my old Scala mentor told me it.  <code>if</code>s just don&#8217;t work with a strong function approach.  Plus you know what - <code>if</code>s are rather ugly especially when you need to wrap ALL THE THINGS in a null check.  Scala has a type called <code>Option</code>.  An <code>Option</code> is essentially a collection of none or one instances of a type.  If everything returned an <code>Option</code> nothing would be null and you don&#8217;t need to do any null checks (they are much more powerful than I am making out but for now this is all that is necessary).</p>

<p>Kotlin doesn&#8217;t have the <code>Option</code> type but it does have two things that allow you to act like it does,</p>

<ol>
<li>Nullable types - e.g. <code>String</code> vs <code>String?</code> , and,</li>
<li>Nullable Extension Functions</li>
</ol>


<p>Remember the brief definition of an <code>Option</code> - it&#8217;s a list of 0 or 1 instances of a particualr type and as such we can treat it a bit like a list.  Now once we get functional with our badselves this makes null handling unnecessary.  We can use all those nice little functional methods that you get with collections - map, forEach, filter, fold etc.</p>

<p>This means you&#8217;re less inclined to use <code>if</code>s and, more importantly, less inclined to use mutable variables which is great for building performant, scalable soltions.</p>

<p>Lets take a really contrived example to show you what I mean.  OImagine this bit of code&#8230;.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'>   <span class="n">val</span> <span class="n">auth</span> <span class="o">=</span> <span class="n">authenticate</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">)</span>
</span><span class='line'>   <span class="n">var</span> <span class="n">view</span> <span class="o">:</span> <span class="n">View</span> <span class="o">=</span> <span class="kc">null</span>
</span><span class='line'>
</span><span class='line'>   <span class="k">if</span> <span class="o">(</span><span class="n">auth</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
</span><span class='line'>          <span class="n">view</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="s">&quot;Invalid Username or Password&quot;</span><span class="o">)</span>
</span><span class='line'>   <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span><span class='line'>          <span class="n">view</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">index</span><span class="o">(</span><span class="n">auth</span><span class="o">)</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>   <span class="k">return</span> <span class="n">view</span>
</span></code></pre></td></tr></table></div></figure>


<p>We want to authenticate a user and return a certain view.  Now yes we could refactor this down into something more bitsize but this is a very common state to find code - so bare with me for demonstration purposes.</p>

<p><code>authenticate</code> returns a user if the username and password was correct otherwise it returns null.  With our nullable extensions (by importing <code>kotlin.nullable.*</code>) we can reduce this into something more Scala-like,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="k">return</span> <span class="nf">authenticate</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">).</span><span class="na">map</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">index</span><span class="o">(</span><span class="n">it</span><span class="o">)</span>
</span><span class='line'><span class="o">}</span> <span class="o">?:</span> <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="s">&quot;Invalid Username or Password&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So what we have done here is basically take an object (the user), if it exists, and transform it to another object which we return.  Otherwise we return something different.  This is much simpler and avoids having to create a mutable var (yes we could have avoided that in the other example but in many cases its very difficult to achieve this).  In fact I am not even a fan of the elvis operator there (<code>?:</code>) and have a Scala-like syntax <a href="https://github.com/JetBrains/kotlin/pull/100">pull request</a> open for getOrElse.  A small syntactic change that I think allows you create a much neater, chainable block of code.</p>

<p>Thats only the tip of the iceberg on Nullable Extensions - those of you with a functional mind will be able to put these collection-like extensions to great use I reckon.  Not quite Scalas <code>Option</code> type but good enough at providing the common features for me.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Kotlin: Extension Functions]]></title>
    <link href="http://yobriefca.se/blog/2012/07/16/kotlin-extension-functions/"/>
    <updated>2012-07-16T22:04:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/16/kotlin-extension-functions</id>
    <content type="html"><![CDATA[<p>In any language (that supports the concept) extension functions are nothing more than syntactic sugar.  Instead of writing,</p>

<pre><code>StringUtils.encrypt(mystring, "salt")
</code></pre>

<p>Extension functions allow you to write,</p>

<pre><code>mystring.encrypt("salt")
</code></pre>

<p>Once you start moving into the world of chaining things get much cleaner.</p>

<pre><code>encrypted = StringUtils.encrypt(mystring, "salt")
encoded = StringUtils.encode(encrypted, "UTF-8")
</code></pre>

<p>or worse,</p>

<pre><code>StringUtils.encode(StringUtils.encrypt(mystring, "salt"), "UTF-8")
</code></pre>

<p>I&#8217;ve seen this done a few times, it happens.  But with sugary sweet extension functions (Extension Methods in C#, Implicit Conversions in Scala) you could just do this,</p>

<pre><code>mystring.encrypt("salt").encode("UTF-8")
</code></pre>

<p>Much nicer.</p>

<p>Kotlin, unlike crusty old Java, supports extension functions.  Here is how you&#8217;d implement the methods above</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">fun</span> <span class="n">String</span><span class="o">.</span><span class="na">encrypt</span><span class="o">(</span><span class="nl">salt:</span> <span class="n">String</span><span class="o">):</span> <span class="n">String</span> <span class="o">{</span>
</span><span class='line'>   <span class="k">return</span> <span class="nf">StringBuffer</span><span class="o">(</span><span class="k">this</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">salt</span><span class="o">)?.</span><span class="na">reverse</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">fun</span> <span class="n">String</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="nl">encoding:</span> <span class="n">String</span><span class="o">)</span> <span class="o">:</span> <span class="n">ByteArray</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">encoding</span><span class="o">)</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And we can use these, as you&#8217;d expect, like so,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">fun</span> <span class="nf">main</span><span class="o">(</span><span class="nl">args:</span> <span class="n">Array</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;)</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">val</span> <span class="n">mystring</span> <span class="o">=</span> <span class="s">&quot;james&quot;</span>
</span><span class='line'>    <span class="n">val</span> <span class="n">encoded</span> <span class="o">=</span> <span class="n">mystring</span><span class="o">.</span><span class="na">encrypt</span><span class="o">(</span><span class="s">&quot;salt&quot;</span><span class="o">).</span><span class="na">encode</span><span class="o">(</span><span class="s">&quot;UTF-8&quot;</span><span class="o">)</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So what identified those functions as Extension Functions?  Simple - the prefixing of the method name with the type <code>String.encode</code>.  No need to create implicit wrappers (Scala), no need to create loads of static classes (C#).  And yes it&#8217;s possible to use generics in these methods as well,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">fun</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span><span class="o">?.</span><span class="na">getOrElse</span><span class="o">(</span><span class="nl">t:</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">T</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span> <span class="o">?:</span> <span class="n">t</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This can be applied to any nullable type.</p>

<h2>Literal Extension Functions</h2>

<p>An interesting little feature that Kotlin has that makes it a bit different is the use of function literal extension functions.  Basically where you can declare a function as a literal (a lambda method if you will) you can also make that literal an extension function,</p>

<p>So we could take our methods we wrote above and bring them right into our <code>main</code></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">fun</span> <span class="nf">main</span><span class="o">(</span><span class="nl">args:</span> <span class="n">Array</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;)</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">val</span> <span class="n">encrypt</span> <span class="o">=</span> <span class="o">{</span> <span class="n">String</span><span class="o">.(</span><span class="nl">salt:</span> <span class="n">String</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">StringBuffer</span><span class="o">(</span><span class="k">this</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">salt</span><span class="o">)?.</span><span class="na">reverse</span><span class="o">().</span><span class="na">toString</span><span class="o">()}</span>
</span><span class='line'>    <span class="n">val</span> <span class="n">encode</span> <span class="o">=</span> <span class="o">{</span> <span class="n">String</span><span class="o">.(</span><span class="nl">encoding:</span> <span class="n">String</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">this</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">encoding</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">val</span> <span class="n">mystring</span> <span class="o">=</span> <span class="s">&quot;james&quot;</span>
</span><span class='line'>    <span class="n">val</span> <span class="n">encoded</span> <span class="o">=</span> <span class="n">mystring</span><span class="o">.</span><span class="na">encrypt</span><span class="o">(</span><span class="s">&quot;salt&quot;</span><span class="o">).</span><span class="na">encode</span><span class="o">(</span><span class="s">&quot;UTF-8&quot;</span><span class="o">)</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This may seem quite unnecessary at first glance but it become quite powerful when creating DSLs - as demonstrated in the docs around the <a href="http://confluence.jetbrains.net/display/Kotlin/Type-safe+Groovy-style+builders">Groovy Style Builders</a></p>

<p>So Kotlin has extension functions that don&#8217;t require a load of boilerplate (C#) or rather odd implicit syntax (Scala) - cool, right?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Kotlin: Here's What I Think (For Now)]]></title>
    <link href="http://yobriefca.se/blog/2012/07/15/kotlin-heres-what-i-think/"/>
    <updated>2012-07-15T16:43:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/15/kotlin-heres-what-i-think</id>
    <content type="html"><![CDATA[<blockquote><p>Before I go shooting my mouth off here - a word of warning - I haven&#8217;t really done anything with Kotlin.  I&#8217;ve read the docs, played with the <a href="https://github.com/dodyg/Kotlin101">Kotlin 101 samples</a> and written a few small console type apps.  So take what you want from this post.</p></blockquote>

<p>Want to hear something zany?  There actually are people - real living people, with a fully working brain, many much smarter than me - that are &#8220;happy&#8221; with Java.</p>

<p>Seriously.</p>

<p>I made a move from Java to .NET about 5 years ago and have dipped back in a few times over that period.  Trying new languages is a sure fire way, for some at least, to make you realise Java is not a language that makes coding fun, or productive.  Java put me right of the JVM.  Any language that makes woking with collections (something you&#8217;ll do alot) so long winded and noisy deserves to be shunned.  But this isn&#8217;t a Java rant - the JVM is great but it&#8217;s just marketed badly because of Java.</p>

<p>But all the JVM-hate that Java instilled in me 5 years ago; the last 6 months of working with Scala has replaced with love.  So I&#8217;ve been looking around the JVM world and discovered <a href="http://kotlin.jetbrains.org/">Kotlin</a> a new JVM based language from JetBrains.  Its much closer to Java than what Scala or Clojure is (intentionally).</p>

<p>One main thing that Kotlin brings to the table is pragmatism.  Without trying to belittle Kotlin - it&#8217;s almost like CoffeeScript for Java (yep kind of like what <a href="http://www.eclipse.org/xtend/">Xtend</a> is.  Kotlin removes all those annoying necessities in Java that make your code verbose (checked exceptions, semi-colons, null reference checks etc.).  It also adds things that make your life much easier (extension methods, functional collection manipulation etc.).</p>

<p>When you write Ruby for the first time you notice that many things just work out like you&#8217;d expect, the syntax is quite natural.  The same cannot be said for Java - there is just way too much boilerplate.  Kotlin helps reduce that boilerplate.  So, by extension, it could be said that Kotlin makes you more productive.  A person who knows Java will find Kotlin no challenge to start using - the syntax is nicely aligned, just without the noise.</p>

<p>Many people, when trying to get their team to adopt Scala, use the &#8220;you can use Scala like Java til you get used to it&#8221; mantra.  I don&#8217;t agree with that.  Academically it&#8217;s true but the minute you start working with other peoples Scala code - you&#8217;ve just gotta know Scala and when they have a slew of Implicits thrown in your Scala as Java stuff goes out the window.  Kotlin, on the other hand, has some of the nice functional patterns from Scala but none of the &#8220;magic-to-a-newcomer&#8221; features that can make grown men weep.  Now the Kotlin docs themselves even go as far as stating</p>

<blockquote><p>  If you are happy with Scala, you probably don&#8217;t need Kotlin.</p></blockquote>

<p>But I think they are selling themselves short - I think plenty of people use Scala but could easily use Kotlin in its place and find themselves in a better place (easier upskilling, less cryptic codebase).</p>

<p>Anyway this is a bit of a ramble, what I&#8217;m saying is - Kotlin has some really rather nice features (Groovy Like DSL Builders, Pattern Matching, the <code>when</code> expression, lambdas, Kotlin to JavaScript compilation(!) etc.) and people happy with either Java OR Scala should give it a go.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Technology in the Cloud]]></title>
    <link href="http://yobriefca.se/blog/2012/07/12/technology-in-the-cloud/"/>
    <updated>2012-07-12T13:59:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/12/technology-in-the-cloud</id>
    <content type="html"><![CDATA[<p>The Cloud.  As much as the term has been pummelled into meaningless marketing sputum by the guys in expensive suits and fake smiles it does exist and is distinct from a typical &#8220;throw all your stuff in a data center&#8221; setup.</p>

<p>The Cloud is distinct, as well, in terms of how you think about your solution architecture.  The typical old school approach would be to just create big monoliths to process your data but that doesn&#8217;t work out so well in the cloud.  Of course the considerations for the cloud aren&#8217;t new, hell no - things like SOA have been around for an age, but if you want to harness the benefits of the cloud as the internet intended you will be narrowing your options.  No more just cobbling common bits together and crossing your fingers.</p>

<p>So fine - architecting for the cloud has some special considerations but thats not what I want to talk about - there are better people than me to cover that.</p>

<p>What I want to talk about is use of technology within that architecture.  I&#8217;ve never been a fan of the one-size-fits-all-painful-or-not technology stack driven almost solely by a need to avoid unnecessary education of developers.  And, now I feel the cloud is strengthening my view that a default stack is more trouble than it&#8217;s worth.  More importantly it&#8217;s really adding momentum to the whole polyglot architecture, or simply using the right tools for the job.</p>

<p>Let me explain.  Any default stack, by definition, needs to cater to many user cases and as such brings a certain amount of sacrifice with it.  Sacrifices come in many forms but usually in performance, memory footprint and/or verbose configuration.  In the cloud you are, in essence, in a Pay-As-You-Go model, every clock cycle and every bit of storage costs.  Now that heavy ORM with its less than ideal queries and slow relationship mapping is starting to cost you money EVERY request.  <span class='pullquote-right' data-pullquote='"In the cloud the default stack can easily bleed money." '> In fact, it&#8217;s probably backed by that storage heavy relational database for all your non-relational data.  Same for that rather large web framework you&#8217;ve got there&#8230;. every time to deal with a spike and scale that badboy out and you&#8217;re having to use medium instances rather than small.  That SOAP based webservice that requires triple the bandwidth to service a request&#8230; ugh you get the point. &#8220;In the cloud the default stack can easily bleed money.&#8221;
</span></p>

<p>I guess this is less about the default stack and more about just using the right tools to get the job done in the most effective manner - afterall you&#8217;re paying for this stuff now.  You kind of were before but in such a coarse grained manner it didn&#8217;t matter - it does now.</p>

<p>In summary - the cloud has started to make technology decisions more accountable and we need to ensure that those decisions aren&#8217;t costing our stakeholders more money than necessary.</p>

<p>PS.</p>

<p>I&#8217;m not going to sit here and preach about the which specific technologies to use but come on - if your storing Session State in a Oracle database, switch to Riak, or Redis.  If you&#8217;re building a nice scalable API then use something like Scala which promotes immutable state and concurrency out of the box over something like vanilla Java (or perhaps just a better framework Spring-WS vs Dropwizard for example).  JSON over XML or a binary format (Protobuf for example) for machine to machine communication.  A small node.js web site over ASP.NET Webforms for simple sites.  The list goes on.  That is to say consider this advice against the other factors driving technical decisions - dont JUST go for the smallest, lightest tools because it MIGHT be cheaper.  Do the research.</p>

<p>Finally, perhaps you&#8217;ve got another IT team needing to support this new solution?  Bring them along this journey too, educate them as you educate yourself, dont just throw the finished thing over the wall with a 1 week handover and a pat on the back.</p>

<p>Don&#8217;t be afraid - it&#8217;s a super fun world we live in!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Azure Website Workflow for Bosses]]></title>
    <link href="http://yobriefca.se/blog/2012/07/12/azure-website-workflow-for-bosses/"/>
    <updated>2012-07-12T12:23:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/12/azure-website-workflow-for-bosses</id>
    <content type="html"><![CDATA[<blockquote><p>So consider my indefinite hiatus suspended definitely.  I suck at quitting!  But we wont dive into the whys and wherefores  around that now.</p></blockquote>

<p>I&#8217;ve a confession to make, the &#8220;new&#8221; Azure, I like it.  Yeah I do, s&#8217;nice.  I like the way it blends PaaS with IaaS (though I do feel that adding 1st class node.js and PHP support is a bit of a tacked on marketing ploy).  So you dont have the &#8220;Add-On&#8221; model you get from Appharbor and Heroku but thats fine because this blending of &#8220;as a Services&#8221; gives you an alternate approach.  For a start you can just use the external services without them having to be &#8220;Add-Ons&#8221;.  Sure you lose out on the nice automatic integration points for managing your services but it&#8217;s not the end of the world and what happens when you want something that isn&#8217;t available as an Add-On or worse not available as a cloudy SaaS thing?  Well I guess you need to go off to EC2 or similar and host your own (assuming you want to stick with the cloudy infrastructure).  But with Azure you also get another option - you want to use Mongo or some huge enterprisey platform that isn&#8217;t SaaSified?  Stick it on an Azure VM.  Everything managed under one cloud provider.  Thats such a nice thing to have at your disposal.</p>

<p>But thats not the point of this post.  Most posts out there cover a workflow for Azure WebSites that make use of the portal to provision new sites (and then usually <code>git</code> to deploy) but that&#8217;s weak sauce (the portal part at least - gits still aces).  No, no no - You want hyper-productivity, you want automated provisioning,  you want to be hip; node.js hip; and you want to feel like a boss hanging out on your command line while other &#8220;lesser people&#8221; click stuff with a silly little rodent.  I just read your mind, didn&#8217;t I?  Well then - you got that with Azure.</p>

<h2>Setting Up</h2>

<p>First things first you need to install a few things.</p>

<h3>Installing node.js + NPM</h3>

<p><a href="http://nodejs.org/#download">Download</a></p>

<p>The tools are built and deployed in node via NPM, the node package manager so just run the one click installer and you&#8217;ll be all setup.</p>

<h3>Installing Azure CLI Tools</h3>

<p>Install these via NPM so fire up your terminal/command prompt/whatever and type</p>

<pre><code>npm install azure -g
</code></pre>

<p>Then let NPM install all the dependencies and what not (the <code>-g</code> option just tells NPM to install the tools globally so they are accessible from the command line)</p>

<h3>Adding your account</h3>

<p>Next up you need to tell azure what account to use so fire this command into you command line</p>

<pre><code>azure account download
</code></pre>

<p>You&#8217;ll then be taken to the Azure website and it should (assuming you&#8217;re logged in already) download a <code>publishsettings</code> file.  Next up you need to import this file into your azure toolchain.</p>

<pre><code>azure account import YOUR_DOWNLOADED_FILE.publishsettings
</code></pre>

<p>After some scrolling text you&#8217;ll be all set up and ready to deploy.  You&#8217;ll be asked to delete the file you downloaded - probably best to do this :)</p>

<h2>Creating the app</h2>

<p>OK then lets create an app - what we create is irrelevant here so lets just create the default ASP.NET MVC website and use that as our sample app.  Remeber though, if you&#8217;re a cutting edge awesome-addict to switch from .NET 4.5 to 4 or else you&#8217;ll get some issues when deploying your site to Azure.</p>

<blockquote><p><strong>UPDATE</strong> : The next few steps can be condensed, thanks to the feedback from Glenn Block (@gblock),
<blockquote class="twitter-tweet" data-in-reply-to="224800579388575744"><p>@<a href="https://twitter.com/kouphax">kouphax</a> oh dude, you don&#8217;t need all those steps! Do &#8220;azure site create my site &#8211;git&#8221; It will create the repo for you and add the remote!</p>&mdash; Glenn Block (@gblock) <a href="https://twitter.com/gblock/status/224855192800215040" data-datetime="2012-07-16T13:17:10+00:00">July 16, 2012</a></blockquote></p></blockquote>

<script src="http://yobriefca.se//platform.twitter.com/widgets.js" charset="utf-8"></script>


<blockquote><p>This sets up your git repo during creation of the site, adds the remote endpoint and even generates a .gitignore file (which you need to edit yourelf for .NET projects.  WIN!!!!</p>

<p>Anyway&#8230;. on with the old post.</p></blockquote>

<p>Once you&#8217;ve created you app and saved it then you&#8217;ll want to intialise an empty repo at the root of the solution,</p>

<pre><code>git init
</code></pre>

<p>Then we need to create a site on Azure we can push to.</p>

<h2>Creating a new site</h2>

<p>Back to the command line now,</p>

<pre><code>azure site create SITE_NAME
</code></pre>

<p>If we execute this, again at the root of our solution, it will do a number of things,</p>

<ol>
<li>Validate the request (site name availability and what not)</li>
<li>Create a new site on Azure</li>
<li>Add a new git <code>remote</code> to your <code>.git\config</code> file</li>
</ol>


<h2>Pushing site</h2>

<p>As I&#8217;ve said the last command actually added a remote repo to our git configuration so if we do the usual gitty stuff (you&#8217;ll want to, for neatness sake, set up your <code>.gitignore</code> but we can skip this for brevity),</p>

<pre><code>git add -A
git commit -m "Boring commit message"
</code></pre>

<p>Now we push,</p>

<pre><code>git push azure master
</code></pre>

<p>Done!</p>

<h2>Viewing your site</h2>

<p>You could just browse to your new site but thats just not hip enough, hell no.  Instead lets launch it from the command line&#8230;</p>

<pre><code>azure site browse
</code></pre>

<p>That will launch our new site without having to touch a silly old, out of date rodent.</p>

<h2>Wrapping up</h2>

<p>Ok so thats the basic workflow for using CLI tools to manage Azure sites.  You can do this with most of the Azure services (VMs, Certs, Cloud Services etc.) aswell.</p>

<p>So apart from making you look all hackery working in the terminal it does have other uses, specifically around the fact terminal command can be easily executed in a headless automated environment.  Think of creating new sites as part of your CI&#8217;s deployment pipeline, or as part of some disaster recovery process.  The possibilities are endless&#8230; heck even write your own UI for managing sites or deploying new sites/VM/whatever!</p>

<p>So lets see -</p>

<ul>
<li>CLI hackery coolness&#8230; </li>
<li>Node.js hipster bragging rights&#8230; </li>
<li>Azure website created and deployed with about 6 commands&#8230; </li>
</ul>


<p>Not bad for a few minutes work!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Quitsies, Well Sort Of]]></title>
    <link href="http://yobriefca.se/blog/2012/07/03/quitsies/"/>
    <updated>2012-07-03T19:08:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/03/quitsies</id>
    <content type="html"><![CDATA[<blockquote><p>You know when you start to question why you write these things it&#8217;s probably time to quit, or at least take a break.</p>

<p> ~ me, just there now</p></blockquote>

<p>This more of an FYI to anyone who may read this blog than a horrible diatribe about how I am wasting my life with meaningless exercises or technologies I&#8217;ll never get to use to a bunch of people that don&#8217;t really care, what would be the point?  Plus - it&#8217;s probably not even true.</p>

<p>So rather than pottering on about cool and interesting technologies that will make everyones (read, developers) life infinitely better 100% guaranteed I&#8217;ve decided to devote my time to,</p>

<ol>
<li>Working on some startup-py type things that have been milling around the back of my head for some time, and,</li>
<li>Generally getting stuff done</li>
</ol>


<p>Yep, like a hipster band, this little testament to bike-shedding is going on indefinite hiatus.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Quick and Dirty, Super Ugly,] Starter for 10 - Dropwizard]]></title>
    <link href="http://yobriefca.se/blog/2012/07/03/starter-for-10-dropwizard/"/>
    <updated>2012-07-03T13:07:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/07/03/starter-for-10-dropwizard</id>
    <content type="html"><![CDATA[<p>So once again I&#8217;m writing Java without a gun to my head, and once again I&#8217;m finding it enjoyable.  Don&#8217;t get me wrong Java as a language feels very long winded, old and cumbersome but the frameworks and stuff that exist around it actually make those issues, less prominent, so much so I think I could easily live with the noise that Java brings.</p>

<p>Anywho.</p>

<p><a href="http://dropwizard.codahale.com/">Dropwizard</a> is a framework for creating very simple ReSTful Web Services in Java.  Not just that but it also bundles some nice best practise in with it as well.  Things like pluggable health checks, logging, configuration, content negotiation etc.  And, because it&#8217;s fairly lightweight its fast.  Very fast.</p>

<p>In fact you can think of Dropwizard as a collection of pre-existing tools glued together with some simple features to create a cohesive stack for HTTP+JSON web services.  You&#8217;ve got <a href="http://www.eclipse.org/jetty/">Jetty</a>, <a href="http://jersey.java.net/">Jersey</a>, <a href="http://jackson.codehaus.org/">Jackson</a>, <a href="http://metrics.codahale.com/">Metrics</a>, <a href="http://logback.qos.ch/">Logback</a>, <a href="http://www.jdbi.org/">JDBI</a> and more.  Dropwizard give you the glue that binds these along with a simple pipeline that makes use of these technologies.</p>

<h2>Simple Todo</h2>

<p>I had intended to do something a little more substantial but I am about to make a small annoucemnet that has kind of effectivley stopped me expanding this app much further.  So lets create a simple Todo App.</p>

<h3>pom.xml</h3>

<p>As with most Java projects lets start with the <code>pom.xml</code> which is effectively our project definition.  I&#8217;ll not show you my entire POM, at least not on the first date, but let me reveal the important parts.</p>

<p> Beause it&#8217;s awesome I want to include WebJars so I add my repository,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>    <span class="nt">&lt;repositories&gt;</span>
</span><span class='line'>        <span class="nt">&lt;repository&gt;</span>
</span><span class='line'>            <span class="nt">&lt;id&gt;</span>webjars<span class="nt">&lt;/id&gt;</span>
</span><span class='line'>            <span class="nt">&lt;url&gt;</span>http://webjars.github.com/m2<span class="nt">&lt;/url&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/repository&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/repositories&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next I add my dependencies,</p>

<ol>
<li>Dropwizard Core which has everything you&#8217;ll need for this</li>
<li>jQuery from the WebJar repository</li>
</ol>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>    <span class="nt">&lt;dependencies&gt;</span>
</span><span class='line'>        <span class="nt">&lt;dependency&gt;</span>
</span><span class='line'>          <span class="nt">&lt;groupId&gt;</span>com.yammer.dropwizard<span class="nt">&lt;/groupId&gt;</span>
</span><span class='line'>          <span class="nt">&lt;artifactId&gt;</span>dropwizard-core<span class="nt">&lt;/artifactId&gt;</span>
</span><span class='line'>          <span class="nt">&lt;version&gt;</span>0.4.2<span class="nt">&lt;/version&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/dependency&gt;</span>
</span><span class='line'>        <span class="nt">&lt;dependency&gt;</span>
</span><span class='line'>          <span class="nt">&lt;groupId&gt;</span>com.jquery<span class="nt">&lt;/groupId&gt;</span>
</span><span class='line'>          <span class="nt">&lt;artifactId&gt;</span>jquery<span class="nt">&lt;/artifactId&gt;</span>
</span><span class='line'>          <span class="nt">&lt;version&gt;</span>1.7.2-1<span class="nt">&lt;/version&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/dependency&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/dependencies&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>I also add the <a href="http://maven.apache.org/plugins/maven-shade-plugin/">shade plugin</a> which will let me build a Fat Jar (a jar with all my dependencies and what not in it).</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>    <span class="nt">&lt;plugin&gt;</span>
</span><span class='line'>        <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span><span class='line'>        <span class="nt">&lt;artifactId&gt;</span>maven-shade-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span><span class='line'>        <span class="nt">&lt;version&gt;</span>1.6<span class="nt">&lt;/version&gt;</span>
</span><span class='line'>        <span class="nt">&lt;configuration&gt;</span>
</span><span class='line'>            <span class="nt">&lt;createDependencyReducedPom&gt;</span>true<span class="nt">&lt;/createDependencyReducedPom&gt;</span>
</span><span class='line'>            <span class="nt">&lt;filters&gt;</span>
</span><span class='line'>                <span class="nt">&lt;filter&gt;</span>
</span><span class='line'>                    <span class="nt">&lt;artifact&gt;</span>*:*<span class="nt">&lt;/artifact&gt;</span>
</span><span class='line'>                    <span class="nt">&lt;excludes&gt;</span>
</span><span class='line'>                        <span class="nt">&lt;exclude&gt;</span>META-INF/*.SF<span class="nt">&lt;/exclude&gt;</span>
</span><span class='line'>                        <span class="nt">&lt;exclude&gt;</span>META-INF/*.DSA<span class="nt">&lt;/exclude&gt;</span>
</span><span class='line'>                        <span class="nt">&lt;exclude&gt;</span>META-INF/*.RSA<span class="nt">&lt;/exclude&gt;</span>
</span><span class='line'>                    <span class="nt">&lt;/excludes&gt;</span>
</span><span class='line'>                <span class="nt">&lt;/filter&gt;</span>
</span><span class='line'>            <span class="nt">&lt;/filters&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/configuration&gt;</span>
</span><span class='line'>        <span class="nt">&lt;executions&gt;</span>
</span><span class='line'>            <span class="nt">&lt;execution&gt;</span>
</span><span class='line'>                <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
</span><span class='line'>                <span class="nt">&lt;goals&gt;</span>
</span><span class='line'>                    <span class="nt">&lt;goal&gt;</span>shade<span class="nt">&lt;/goal&gt;</span>
</span><span class='line'>                <span class="nt">&lt;/goals&gt;</span>
</span><span class='line'>                <span class="nt">&lt;configuration&gt;</span>
</span><span class='line'>                    <span class="nt">&lt;transformers&gt;</span>
</span><span class='line'>                        <span class="nt">&lt;transformer</span> <span class="na">implementation=</span><span class="s">&quot;org.apache.maven.plugins.shade.resource.ServicesResourceTransformer&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>                        <span class="nt">&lt;transformer</span> <span class="na">implementation=</span><span class="s">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>                            <span class="nt">&lt;mainClass&gt;</span>se.yobriefca.TodoService<span class="nt">&lt;/mainClass&gt;</span>
</span><span class='line'>                        <span class="nt">&lt;/transformer&gt;</span>
</span><span class='line'>                    <span class="nt">&lt;/transformers&gt;</span>
</span><span class='line'>                <span class="nt">&lt;/configuration&gt;</span>
</span><span class='line'>            <span class="nt">&lt;/execution&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/executions&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/plugin&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Configuration</h3>

<p>Dropwizard has the ability to map configuration options (from a YML or JSON file) into concrete classes that can be accessed by your services.  So first I created a todo.yml at the root of the project (beside the pom.xml) with some basic configuration</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>http:
</span><span class='line'>    rootPath: &quot;/app/*&quot;
</span></code></pre></td></tr></table></div></figure>


<p>This configuration tells Dropwizard that my services are located at a url starting with  <code>/app</code> - eg <code>/app/todo</code>.  This is necessary as I want to create an asset later that maps to the root url <code>/</code> that is the default of Dropwizard.  At this point I haven&#8217;t needed any of my own configuration but if I did I could create a POJO that maps to proeprties in this file.  The <a href="http://dropwizard.codahale.com/getting-started/#creating-a-configuration-class">official guide</a> has more on this.  For now I will create an empty <code>Configuration</code> class in case I want to extend it later (yeah I know YAGNI YAGNI KISS YAGNI - shutuppayourface!)</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">se</span><span class="o">.</span><span class="na">yobriefca</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.yammer.dropwizard.config.Configuration</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoConfiguration</span> <span class="kd">extends</span> <span class="n">Configuration</span> <span class="o">{</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Service</h3>

<p>The service is the core class in our solution.  It&#8217;s the thing that has the <code>main</code> as an entry point.  The thing that &#8220;set us up the resouces&#8221; and registers healthchecks and controls our service lifecycle.  You&#8217;d think there would be loads of code here?  Right?  Wrong!</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">se</span><span class="o">.</span><span class="na">yobriefca</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.yammer.dropwizard.Service</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.yammer.dropwizard.bundles.AssetsBundle</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.yammer.dropwizard.config.Environment</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">se.yobriefca.resources.TodoResource</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoService</span> <span class="kd">extends</span> <span class="n">Service</span><span class="o">&lt;</span><span class="n">TodoConfiguration</span><span class="o">&gt;</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">new</span> <span class="nf">TodoService</span><span class="o">().</span><span class="na">run</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">private</span> <span class="nf">TodoService</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">(</span><span class="s">&quot;todo&quot;</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">addBundle</span><span class="o">(</span><span class="k">new</span> <span class="n">AssetsBundle</span><span class="o">(</span><span class="s">&quot;/assets&quot;</span><span class="o">,</span> <span class="s">&quot;/&quot;</span><span class="o">));</span>
</span><span class='line'>        <span class="n">addBundle</span><span class="o">(</span><span class="k">new</span> <span class="n">AssetsBundle</span><span class="o">(</span><span class="s">&quot;/public&quot;</span><span class="o">,</span> <span class="s">&quot;/public/&quot;</span><span class="o">));</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">TodoConfiguration</span> <span class="n">configuration</span><span class="o">,</span> <span class="n">Environment</span> <span class="n">environment</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">environment</span><span class="o">.</span><span class="na">addResource</span><span class="o">(</span><span class="k">new</span> <span class="n">TodoResource</span><span class="o">());</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So all services extend <code>Service</code> and have a <code>Configuration</code> type (FYI these config types can be nested so its not as restrictive as I first thought).  Basically what we have is a <code>main</code> method that create an instance of our service and runs it.  Upon creation we add two bundles to the service.  A bundle is bascially a bit of functionality and in this case we create two <code>AssetBundles</code> which can be used to serve static content (embedded resources) upon request to a specific URL (think things like CSS, JavaScript, HTML etc.)  You&#8217;ll notice I am mapping 2 things bundles here and this is because I need to map to the WebJars directroy as well.  So when I got to <code>localhost/index.html</code> it will match the url pattern in the first AssetsBundle and look for a file <code>src/main/resources/assets/index.html</code>.</p>

<p>Finally we have the <code>initialize</code> method that allows us to decare mutliple resources and healthchecks against our environment.  We also get handed our configuration class we decalred in advance.</p>

<h3>A bit about healthchecks</h3>

<p>Healthchecks are little classes that perform some sort of test on a part of your solution.  For example we could have a database connectivity check.  These healthchecks are made available on the <a href="http://dropwizard.codahale.com/manual/core/#health-checks">admin section that is bound to another port</a> when your app starts.</p>

<p>Now I didn&#8217;t define any for this example and for that I feel absolutely terrible.  Seriously I kind of feel sick thinkging about it.  And whats worse Dropwizard kindly reminds me everytime I start the app - using LOTS of exclamantion marks and CAPS!!!  IRL you should really not follow my example here.</p>

<h3>Resources</h3>

<p>Resources are resources as they are identified in ReSTy things.  For example a <code>User</code> is a resource or an <code>Order</code> etc.  These things will respond to HTTP requests matched against the URL and the HTTP Method used.  In my example I have defined a resource <code>Todo</code> that can be used to list, create and delete (I didn&#8217;t need anything else for this).</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="nd">@Path</span><span class="o">(</span><span class="s">&quot;/todos&quot;</span><span class="o">)</span>
</span><span class='line'><span class="nd">@Produces</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoResource</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Todo</span><span class="o">&gt;</span> <span class="n">todos</span> <span class="o">=</span> <span class="n">Lists</span><span class="o">.</span><span class="na">newArrayList</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@GET</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Todo</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">todos</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@POST</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">Todo</span> <span class="nf">add</span><span class="o">(</span><span class="nd">@Valid</span> <span class="n">Todo</span> <span class="n">todo</span><span class="o">){</span>
</span><span class='line'>        <span class="n">todos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">todo</span><span class="o">);</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">todo</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@DELETE</span>
</span><span class='line'>    <span class="nd">@Path</span><span class="o">(</span><span class="s">&quot;/{id}&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">Todo</span> <span class="nf">delete</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="kd">final</span> <span class="n">LongParam</span> <span class="n">id</span><span class="o">){</span>
</span><span class='line'>        <span class="n">Todo</span> <span class="n">todo</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>        <span class="n">List</span><span class="o">&lt;</span><span class="n">Todo</span><span class="o">&gt;</span> <span class="n">todoCopy</span> <span class="o">=</span> <span class="n">Lists</span><span class="o">.</span><span class="na">newArrayList</span><span class="o">(</span><span class="n">todos</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">todos</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// loop past all items in the list and replace the changed one</span>
</span><span class='line'>        <span class="k">for</span> <span class="o">(</span><span class="n">Todo</span> <span class="nl">element:</span> <span class="n">todoCopy</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">if</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="o">!=</span> <span class="n">id</span><span class="o">.</span><span class="na">get</span><span class="o">()){</span>
</span><span class='line'>                <span class="n">todos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
</span><span class='line'>            <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span><span class='line'>                <span class="n">todo</span> <span class="o">=</span> <span class="n">element</span><span class="o">;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">todo</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again not a great deal of code and what code that is there is fairly straightforward - some would say boilerplate.  We use annotations to map our HTTP Methods <code>@GET</code>, <code>@POST</code> and <code>@DELETE</code> as well as a <code>@Path(...)</code> annotation to specify what url this resource resonds to.  Another nice feature we can see annotated here is we get both validation (via the @Valid annotation which is based on Hibernates Validation framework) and JSON model binding via Jackson and model annotations (get to that in a minute).</p>

<p>For this simple demo I am storing a list of Todos in an ArrayList in memory (top of the class).</p>

<h3>Model</h3>

<p>The model is, bar all the annotations to enable serialisation, fairly POJO-like,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Todo</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Not So Universally Unique!</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">AtomicLong</span> <span class="n">NSUUID</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AtomicLong</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@JsonProperty</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@NotEmpty</span>
</span><span class='line'>    <span class="nd">@JsonProperty</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">content</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@JsonCreator</span>
</span><span class='line'>    <span class="kd">public</span> <span class="nf">Todo</span><span class="o">(</span><span class="nd">@JsonProperty</span><span class="o">(</span><span class="s">&quot;content&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">NSUUID</span><span class="o">.</span><span class="na">incrementAndGet</span><span class="o">();</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getContent</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">content</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="n">Long</span> <span class="nf">getId</span><span class="o">(){</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I&#8217;ve put this in more for completeness as there is little involved in this.</p>

<h3>index.html</h3>

<p>I am not going to create some elaborate over architected front end here - just a few lines of JavaScript (ignoring the rather large jQuery library included of course) and not styling.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'>  <span class="nt">&lt;head&gt;</span>
</span><span class='line'>    <span class="nt">&lt;title&gt;</span>Demo<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;body&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;task&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;addTask&quot;</span><span class="nt">&gt;</span>Add Task<span class="nt">&lt;/button&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;todos&quot;</span><span class="nt">&gt;&lt;/ul&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&#39;text/javascript&#39;</span> <span class="na">src=</span><span class="s">&#39;/public/jquery.min.js&#39;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script&gt;</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="c1">// load and replace the list</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s2">&quot;/app/todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todos</span><span class="p">){</span>
</span><span class='line'>          <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span><span class='line'>            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#todos&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
</span><span class='line'>              <span class="s2">&quot;&lt;li&gt;&lt;input type=&#39;checkbox&#39; data-id=&#39;&quot;</span> <span class="o">+</span> <span class="nx">todos</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">id</span> <span class="o">+</span><span class="s2">&quot;&#39;/&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                <span class="nx">todos</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">content</span> <span class="o">+</span>
</span><span class='line'>              <span class="s2">&quot;&lt;/li&gt;&quot;</span>
</span><span class='line'>            <span class="p">)</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// manage adding a new task</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#addTask&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>            <span class="nx">url</span><span class="o">:</span>         <span class="s2">&quot;/app/todos&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">type</span><span class="o">:</span>        <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">data</span><span class="o">:</span>        <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">content</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#task&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="p">}),</span>
</span><span class='line'>            <span class="nx">contentType</span><span class="o">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">dataType</span><span class="o">:</span>    <span class="s2">&quot;json&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">success</span><span class="o">:</span>     <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">){</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#todos&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
</span><span class='line'>                <span class="s2">&quot;&lt;li&gt;&lt;input type=&#39;checkbox&#39; data-id=&#39;&quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span><span class="s2">&quot;&#39;/&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                  <span class="nx">data</span><span class="p">.</span><span class="nx">content</span> <span class="o">+</span>
</span><span class='line'>                <span class="s2">&quot;&lt;/li&gt;&quot;</span>
</span><span class='line'>              <span class="p">)</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>          <span class="p">})</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#todos&quot;</span><span class="p">).</span><span class="nx">delegate</span><span class="p">(</span><span class="s2">&quot;input[type=checkbox]&quot;</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">chk</span>  <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">item</span> <span class="o">=</span> <span class="nx">chk</span><span class="p">.</span><span class="nx">parent</span><span class="p">(</span><span class="s2">&quot;li&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">id</span>   <span class="o">=</span> <span class="nx">chk</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>            <span class="nx">url</span><span class="o">:</span>         <span class="s2">&quot;/app/todos/&quot;</span> <span class="o">+</span> <span class="nx">id</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">type</span><span class="o">:</span>        <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">contentType</span><span class="o">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">dataType</span><span class="o">:</span>    <span class="s2">&quot;json&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">success</span><span class="o">:</span>     <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">){</span>
</span><span class='line'>              <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">){</span>
</span><span class='line'>                <span class="nx">item</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span><span class="s2">&quot;text-decoration&quot;</span><span class="o">:</span> <span class="s2">&quot;line-through&quot;</span><span class="p">});</span>
</span><span class='line'>                <span class="nx">chk</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>          <span class="p">})</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="nt">&lt;/script&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And thats it.  Oh wait I also added a boot command that peforms the maven packing and starts the jar.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn package;java -jar target/todo-0.1.jar server todo.yml</span></code></pre></td></tr></table></div></figure>


<p>Just run <code>./boot</code> (assuming you&#8217;ve chmod&#8217;d the file to be executable) and you&#8217;ll have, assuming I (or you) haven&#8217;t made any mistakes, a Todo service running on port 8080 (with admin/diagnostics stuff on port 8081).</p>

<p>As always the <a href="https://github.com/kouphax/dropwizard-todo">example code is available on Github</a>.  Sorry for the rushed nature of this post, I&#8217;ll hopefully keep tweaking the example on Github till it&#8217;s a bit nicer - perhaps even with tests and comments (YEAH RIGHT!!!!)</p>

<p>In short - Dropwizard - simple ReST services, very little config, very nice.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Super Basic Trello API Wrapper for Scala and Play]]></title>
    <link href="http://yobriefca.se/blog/2012/06/25/super-basic-trello-api-wrapper-for-scala-and-play/"/>
    <updated>2012-06-25T14:43:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/06/25/super-basic-trello-api-wrapper-for-scala-and-play</id>
    <content type="html"><![CDATA[<p>So I am currently doing a bit of work with using Trello as a kind of data store and decided to write a litle app in <a href="http://playframework.org">Play!</a> (the Scala variety of course).  There didn&#8217;t appear to be a library out there to handle some of the basic Trello stuff so over the past 20 minutes I put one together.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">import</span> <span class="nn">play.api.libs.ws.WS</span>
</span><span class='line'>
</span><span class='line'><span class="k">case</span> <span class="k">class</span> <span class="nc">Trello</span><span class="o">(</span><span class="n">key</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">token</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">val</span> <span class="n">host</span> <span class="k">=</span> <span class="s">&quot;https://api.trello.com&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="n">get</span><span class="o">(</span><span class="n">uri</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">query</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span><span class="kt">String</span><span class="o">)*)</span> <span class="k">=</span> <span class="n">request</span><span class="o">(</span><span class="n">uri</span><span class="o">,</span> <span class="n">query</span><span class="k">:_</span><span class="kt">*</span><span class="o">).</span><span class="n">get</span><span class="o">()</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">post</span><span class="o">(</span><span class="n">uri</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">query</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span><span class="kt">String</span><span class="o">)*)</span> <span class="k">=</span> <span class="n">request</span><span class="o">(</span><span class="n">uri</span><span class="o">,</span> <span class="n">query</span><span class="k">:_</span><span class="kt">*</span><span class="o">).</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">put</span><span class="o">(</span><span class="n">uri</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">query</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span><span class="kt">String</span><span class="o">)*)</span> <span class="k">=</span> <span class="n">request</span><span class="o">(</span><span class="n">uri</span><span class="o">,</span> <span class="n">query</span><span class="k">:_</span><span class="kt">*</span><span class="o">).</span><span class="n">put</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">delete</span><span class="o">(</span><span class="n">uri</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">query</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span><span class="kt">String</span><span class="o">)*)</span> <span class="k">=</span> <span class="n">request</span><span class="o">(</span><span class="n">uri</span><span class="o">,</span> <span class="n">query</span><span class="k">:_</span><span class="kt">*</span><span class="o">).</span><span class="n">delete</span><span class="o">()</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">private</span> <span class="k">def</span> <span class="n">request</span><span class="o">(</span><span class="n">uri</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">query</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span><span class="kt">String</span><span class="o">)*)</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>    <span class="nc">WS</span><span class="o">.</span><span class="n">url</span><span class="o">(</span><span class="n">host</span> <span class="o">+</span> <span class="o">(</span><span class="n">uri</span><span class="o">.</span><span class="n">startsWith</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="kc">true</span> <span class="k">=&gt;</span> <span class="n">uri</span>
</span><span class='line'>      <span class="k">case</span> <span class="kc">false</span> <span class="k">=&gt;</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">uri</span>
</span><span class='line'>    <span class="o">})).</span><span class="n">withQueryString</span><span class="o">(</span><span class="n">query</span> <span class="o">++</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">&quot;key&quot;</span> <span class="o">-&gt;</span> <span class="n">key</span><span class="o">,</span> <span class="s">&quot;token&quot;</span> <span class="o">-&gt;</span> <span class="n">token</span><span class="o">)</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Yep it&#8217;s very basic and all but the <code>get</code> is untested (it&#8217;s all I&#8217;ve needed so far).  But in the spirit of shipping early this is a good start.  The class makes use of Play!s uberflexible <code>WS</code> class and returns <code>Promise[Request]</code> so you can use it like so (just an example)</p>

<p>A simple API object to wrap the Trello class instance to load cards and map them into my expected objects</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">Api</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">val</span> <span class="n">api</span> <span class="k">=</span> <span class="nc">Trello</span><span class="o">(</span><span class="nc">KEY</span><span class="o">,</span> <span class="nc">TOKEN</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">implicit</span> <span class="k">object</span> <span class="nc">CardFormat</span> <span class="k">extends</span> <span class="nc">Format</span><span class="o">[</span><span class="kt">Card</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">reads</span><span class="o">(</span><span class="n">json</span><span class="k">:</span> <span class="kt">JsValue</span><span class="o">)</span><span class="k">:</span> <span class="kt">Card</span> <span class="o">=</span> <span class="nc">Card</span><span class="o">(</span>
</span><span class='line'>      <span class="o">(</span><span class="n">json</span> <span class="o">\</span> <span class="s">&quot;name&quot;</span><span class="o">).</span><span class="n">as</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
</span><span class='line'>      <span class="o">(</span><span class="n">json</span> <span class="o">\</span> <span class="s">&quot;due&quot;</span><span class="o">).</span><span class="n">as</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
</span><span class='line'>    <span class="o">)</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">writes</span><span class="o">(</span><span class="n">card</span><span class="k">:</span> <span class="kt">Card</span><span class="o">)</span><span class="k">:</span> <span class="kt">JsValue</span> <span class="o">=</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">NotImplementedException</span><span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="n">getPastTalks</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;/1/lists/_____&quot;</span><span class="o">,</span> <span class="s">&quot;cards&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;open&quot;</span><span class="o">,</span> <span class="s">&quot;card_fields&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;desc,name,due&quot;</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">res</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="n">json</span> <span class="o">\</span> <span class="s">&quot;cards&quot;</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">JsArray</span><span class="o">(</span><span class="n">cards</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">cards</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">_</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">Card</span><span class="o">])</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And calling this bad boy from a controller.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">Application</span> <span class="k">extends</span> <span class="nc">Controller</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">index</span> <span class="k">=</span> <span class="nc">Action</span> <span class="o">{</span>
</span><span class='line'>    <span class="nc">Async</span> <span class="o">{</span>
</span><span class='line'>      <span class="nc">Api</span><span class="o">.</span><span class="n">getPastTalks</span><span class="o">.</span><span class="n">map</span> <span class="o">{</span> <span class="n">talks</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="nc">Ok</span><span class="o">(</span><span class="n">views</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">index</span><span class="o">(</span><span class="n">talks</span><span class="o">))</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So - lots of work to do around this - I want to move away from a thin wrapper to something a bit more robust with strong classes for the different entites.</p>

<p>Also if you want to find out where to get the API keys etc. go read the decent <a href="https://trello.com/docs/">API docs from Trello</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Two Hidden Gems in Play 2's Template Engine]]></title>
    <link href="http://yobriefca.se/blog/2012/06/17/two-hidden-gems-in-play-2s-template-engine/"/>
    <updated>2012-06-17T19:06:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/06/17/two-hidden-gems-in-play-2s-template-engine</id>
    <content type="html"><![CDATA[<p>Poking around some <a href="http://www.playframework.org/">Play 2</a> <a href="http://www.playframework.org/documentation/2.0.1/Samples">samples</a> today I came across some little bits of sugar.  I haven&#8217;t seen mention of them in other places (they must be well hidden) but they are two very common things I&#8217;ve implemented in less elegant ways in the past.  That was reason enough for me to throw a quick post up about them.</p>

<p>Prepare to have your minds blown.  Well not blown - gently nudged probably.</p>

<h2>String.when</h2>

<p><code>"somestring".when(predicate: =&gt; Boolean)</code> allows you conditionally spit out the value of the string it is called on (otherwise returning and empty string).</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="s">&quot;returned_string&quot;</span><span class="o">.</span><span class="n">when</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>      <span class="c1">// returns &quot;returned_string&quot;</span>
</span><span class='line'><span class="s">&quot;nonreturned_string&quot;</span><span class="o">.</span><span class="n">when</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>  <span class="c1">// returns &quot;&quot; (empty string)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So in the context of views what is this good for?  Lots of things but the most clever use for this little function is conditional css.  Imagine you&#8217;ve got a block of HTML that represents a message area. These messages can be either good or bad and so we need to add the css class of <code>message-bad</code> depending on an argument passed in to the view.  A very quick and dirty way of handling this would be as such</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">@(</span><span class="n">message</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">successful</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="-Symbol">&#39;message</span> <span class="nd">@if</span><span class="o">(!</span><span class="n">successful</span><span class="o">){</span> <span class="s">&quot;message-bad&quot;</span> <span class="o">}</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="nd">@message</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Grand, fine.  It&#8217;s a bit noisy but it works. <code>when()</code> makes this a bit neater IMHO.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">@(</span><span class="n">message</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">successful</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="-Symbol">&#39;message</span> <span class="o">@(</span><span class="s">&quot;message-bad&quot;</span><span class="o">.</span><span class="n">when</span><span class="o">(!</span><span class="n">successful</span><span class="o">))</span><span class="err">&#39;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="nd">@message</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Yep the line is the same length but it looks more like a single block of conditional code, it flows much better and, I think at least, is much more readable.</p>

<h2>Date.format(&#8220;&lt;date-format>&#8221;)</h2>

<p><code>new java.util.Date().format(pattern: String)</code> allows you to specify how a date should be formatted in the rendered HTML.  It&#8217;s essentially shorthand for the noise-fest that is <code>SimpleDateFormat</code></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="n">pattern</span><span class="o">).</span><span class="n">format</span><span class="o">(</span><span class="n">date</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the past I&#8217;ve added transient properties to models for displaying the date, or written my own methods on those models.  Both of those approaches should have had me taken out into a field and shot.  <code>format</code> makes things much more straightforward,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">@(</span><span class="n">importantDate</span><span class="k">:</span> <span class="kt">java.util.Date</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="nd">@importantDate</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;dd-MM-yyyy&quot;</span><span class="o">)</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the output will be along the lines of &#8220;29-01-2013&#8221; or whatever the date was.</p>

<p>OK so neither of these are ground breaking or earth shattering (wait they mean the same thing really dont they???) but they are neat to enough to warrant a shout-out here.  Anyone else have any little nuggets in Play 2 they want to share?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[.NET on a Diet]]></title>
    <link href="http://yobriefca.se/blog/2012/06/07/dot-net-on-a-diet/"/>
    <updated>2012-06-07T21:40:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/06/07/dot-net-on-a-diet</id>
    <content type="html"><![CDATA[<h2>Slides</h2>

<script async class="speakerdeck-embed" data-id="4fd0fb8d3bb27c001f0309b7" data-ratio="1.3333333333333333" src="http://yobriefca.se//speakerdeck.com/assets/embed.js"></script>


<h2>Description</h2>

<p>There are plenty of framework options in .NET. We have the big mainstream web frameworks like ASP.NET WebForms and MVC, the ORM abstractions and DataMappers in the form of Entity Framework, NHibernate and iBatis and services such as WCF requiring large amounts of careful configuration to get right. Unfortunately these frameworks can get in the way, abstractions breakdown and leak and eventually we end up fighting against the frameworks limitations.</p>

<p>This session will take a look at the feature-fit lightweight alternatives and how they can be used to compose a technology stack that is cruft-free and fit for purpose.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Monotouch: C# + iOS = Good Times]]></title>
    <link href="http://yobriefca.se/blog/2012/06/07/monotouch-c-number-plus-ios-equals-good-times/"/>
    <updated>2012-06-07T21:38:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/06/07/monotouch-c-number-plus-ios-equals-good-times</id>
    <content type="html"><![CDATA[<h2>Slides</h2>

<script async class="speakerdeck-embed" data-id="4fd0fb533bb27c0022030674" data-ratio="1.3333333333333333" src="http://yobriefca.se//speakerdeck.com/assets/embed.js"></script>


<h2>Code</h2>

<p><a href="https://github.com/kouphax/monotouch-samples-ndc2012">https://github.com/kouphax/monotouch-samples-ndc2012</a></p>

<h2>Description</h2>

<p>MonoTouch allows you to harness all those C# skills and most of those handy .NET/Mono libraries to create truly native apps for iOS with a sprinkle of cross-platform support. But why not just use objective-c you cry? Choice is nice, so is C# and so is the range of libraries available for mono!</p>

<p>In this talk I will dive in to what makes MonoTouch so compelling for .NET developers wanting to break into iOS development and even how these skills can be harnessed to create cross platform native applications for iOS, Android and WP7 through a shared codebase.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mobile, How Do I Develop Thee? Let Me Count the Ways (Long Version)]]></title>
    <link href="http://yobriefca.se/blog/2012/06/07/mobile/"/>
    <updated>2012-06-07T21:36:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/06/07/mobile</id>
    <content type="html"><![CDATA[<h2>Slides</h2>

<script async class="speakerdeck-embed" data-id="4fcf26728a589b001f0040e8" data-ratio="1.3333333333333333" src="http://yobriefca.se//speakerdeck.com/assets/embed.js"></script>


<h2>Description</h2>

<p>Mobile development is a bit like writing web apps back in the browser war days - full of decision anxiety, volatility and platform specific issues. There is no one true answer yet most people think there should be. This talk will cover the popular(ish) options from native all the way to web solutions (and all the mashup magic in-between). Oh yes and some opinion as well.</p>

<p>This is the longer more up to date version of the previous talk.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[5 Years]]></title>
    <link href="http://yobriefca.se/blog/2012/05/26/5-years/"/>
    <updated>2012-05-26T22:11:00+01:00</updated>
    <id>http://yobriefca.se/blog/2012/05/26/5-years</id>
    <content type="html"><![CDATA[<p>So I am sitting here, here being London - 315(ish) miles away from my family, halfway through the <a href="http://nhshackday.com">NHS Hack Day</a> and having a bit of a personal crisis.  I often have these little episodes but this one has been languishing in my dusty old head for a good while - refusing to go away, nagging me every time I have a chance to ponder things.  It&#8217;s the same old thing - why am I doing any of this stuff I do?  I don&#8217;t generally get a great amount of opportunity in work to really stretch my creative urges.  That sort of thing happens on my own time and therefore given my other responsibilities (my wife, family and lifes associated activities) is done under a fairly tight deadline.  Add this to the fact I bore easily of things that aren&#8217;t really benefiting people immediately - I tend to flit, easily, between little unfinished projects.  But wait&#8230;.  I did it again.  You see back there, about 2 sentences ago I just sidelined my entire life.  Thrown between two looming brackets I relegated my wife and family to a byline yet again.  Oy vey.</p>

<p>And this brings me, neatly enough, to the point of this entire ramble.</p>

<p>Five years ago I married my awesome wife and in that time I&#8217;ve done a heap of things - relocated twice, had two kids bought a house, got promoted, pissed everyone off, seen a few countries and bought/traded three cars (which get smaller every time oddly enough).  And through all this hopping around my wife has been the one true constant.  She thinks, most of the time, I don&#8217;t care about her - after all I&#8217;m in London participating in a hackathon on our 5th wedding anniversary because I stupidly didn&#8217;t put two and two together and notice the clash.  So yeah it may damn well seem like she comes in a close second to my hobby/career stuff (you know the stuff I already mentioned was pulling into crisis mode).  But it&#8217;s not true.  I can&#8217;t help the fact I am &#8220;emotionally retarded&#8221;, as my sister once called it, but perhaps once in a while I really should let her know that she means more than she thinks she does.  And here it is.  A little bit of emotional letting if you will.</p>

<p>Dear Emma - happy anniversary, I hope we have plenty more, thank you for putting up with me, you&#8217;re aces.</p>
]]></content>
  </entry>
  
</feed>
