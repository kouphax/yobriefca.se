
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Serialising .NET Resources to JSON for Web Apps - Yo Briefcase!</title>
  <meta name="author" content="James Hughes">

  <link href='http://fonts.googleapis.com/css?family=Port+Lligat+Slab' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Fresca' rel='stylesheet' type='text/css'>

  
  <meta name="description" content="Pop quiz hotshot &ndash; you are building one of them massive single page web apps using something like Sencha where the vast majority of work is &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yobriefca.se/blog/2011/03/29/serialising-net-resources-to-json-for-web-apps">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/feed" rel="alternate" title="Yo Briefcase!" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19143623-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
  <div id="thingyattop" style="height:1px; background-color: #AAA; border-bottom: 1px solid #E0E0E0"></div>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
   
  <header>
                <span style="float:right">
      <a href="/" style="text-decoration:none;"><span class="label label-inverse">Home</span></a>
      <a href="/talks" style="text-decoration:none;"><span class="label label-inverse">Talks</span></a>
      <a href="/feed" style="text-decoration:none;"><span class="label">RSS</span></a>
      <a href="http://twitter.com/kouphax" style="text-decoration:none;"><span class="label">Twitter</span></a>
      <a href="http://github.com/kouphax" style="text-decoration:none;"><span class="label">Github</span></a>
    </span>
    
      <h1 class="entry-title">Serialising .NET Resources to JSON for Web Apps</h1>
    

    
      <p class="meta">
        
          <span class="label" style="margin-right:10px;"><a href="/" style="text-decoration:none; text-transform:none; color:#fff">&larr;</a></span>
         
        








  


<time datetime="2011-03-29T00:00:00+01:00" pubdate data-updated="true">Mar 29<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content">  <p>Pop quiz hotshot &ndash; you are building one of them massive single page web apps  using something like Sencha where the vast majority of work is pushed into the  JavaScript realm and some crazy nut wants everything localised or at least  all text strings push to RESX files.  What do you do?  WHAT DO YOU DO?</p><h2>Option 1</h2><p>Well the most obvious option, and IMHO the most horrible, would be to convert  all those JavaScript files into aspx&rsquo;s or cshtml&rsquo;s or whatever and embed the  resource references directly into the files.</p><p><script src="https://gist.github.com/892038.js"></script></p><p>This is far from nice.  For one it kind of makes any static compression of  the files either impossible or at best annoyingly fiddly.  It also prevents any  sort of quick client side caching unless you use some sort of VaryByCulture  Output Caching strategy on the server side.  Blegh.</p><h2>Option 2</h2><p>The next option, and certainly much better would be to pull out the direct  &lt;%= %&gt; references and store them in another smaller file and reference  them through a global JS object</p><p><script src="https://gist.github.com/892054.js"></script></p><p><script src="https://gist.github.com/892048.js"></script></p><p>This is nicer because it means you can compress and cache the JavaScript file  globally without having to worry about different cultures etc.  It does leave  one annoyance though.  The Strings object above it essentially boiler plate.   The names are a 1:1 mapping of the resource file so we have introduced a layer  of abstraction we have to write manually leaving us open to make some mistakes.   Slightly less blegh, but still blegh.</p><h2>Option 3</h2><p>The solution I like the best is to provide a mechanism for serialising the  Resource file into the equivalent JSON object.  You get all the benefits of  option 2 while not having to worry about having to write the mapping file.  So  lets keep the JS file from the second option and change the ASPX file</p><p><script src="https://gist.github.com/892069.js"></script></p><p>Now lets look at the magic behind this option &ndash; the JSON Serialiser</p><p><script src="https://gist.github.com/891939.js"></script></p><p>Simple enough little class that is configurable by Culture etc. so you can  pull different translation out on demand if needs be.  Obviously it doesn&rsquo;t do  anything around caching - SRP and all that stuff you know :-P</p><p>Yeah so I&rsquo;ve used this on 2 projects already with great success so hopefully  someone else finds it useful.</p></div>


  <footer>
    <p class="meta">
      








  


<time datetime="2011-03-29T00:00:00+01:00" pubdate data-updated="true">Mar 29<span>th</span>, 2011</time>
      

<span style="float:right">
  
    <a href='/blog/categories/-net/' style='text-decoration:none;'><span class='label label-info'>.net</span></a> <a href='/blog/categories/json/' style='text-decoration:none;'><span class='label label-info'>json</span></a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://yobriefca.se/blog/2011/03/29/serialising-net-resources-to-json-for-web-apps/" data-via="kouphax" data-counturl="http://yobriefca.se/blog/2011/03/29/serialising-net-resources-to-json-for-web-apps/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>
    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/03/13/coffeescript-javascript-sans-bad-parts/" title="Previous Post: CoffeeScript: JavaScript sans Bad Parts">&laquo; CoffeeScript: JavaScript sans Bad Parts</a>
      
      
        <a class="basic-alignment right" href="/blog/2011/04/04/a-tale-of-unit-testing-technologies/" title="next Post: A Tale of Unit Testing Technologies">A Tale of Unit Testing Technologies &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <script>var dis_inpost = true;</script>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

    </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'kouphax';
      
        
        if(window.dis_inpost){
          var disqus_identifier = 'http://yobriefca.se/blog/2011/03/29/serialising-net-resources-to-json-for-web-apps/';
          var disqus_url = 'http://yobriefca.se/blog/2011/03/29/serialising-net-resources-to-json-for-web-apps/';
          var disqus_script = 'embed.js';
        }else{
          var disqus_script = 'count.js';
        }

      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
