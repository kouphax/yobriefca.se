
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Unobtrusive JavaScript in MVC3 - Yo Briefcase!</title>
  <meta name="author" content="James Hughes">

  <link href='http://fonts.googleapis.com/css?family=Port+Lligat+Slab' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Fresca' rel='stylesheet' type='text/css'>

  
  <meta name="description" content="One of the &ldquo;it&rsquo;s not new but it&rsquo;s cool&rdquo; features that appeared in the ASP.NET MVC3 Beta was Unobtrusive JavaScript (well &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yobriefca.se/blog/2010/10/23/unobtrusive-javascript-in-mvc3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/feed" rel="alternate" title="Yo Briefcase!" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19143623-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
  <div id="thingyattop" style="height:1px; background-color: #AAA; border-bottom: 1px solid #E0E0E0"></div>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
   
  <header>
                <span style="float:right">
      <a href="/" style="text-decoration:none;"><span class="label label-inverse">Home</span></a>
      <a href="/talks" style="text-decoration:none;"><span class="label label-inverse">Talks</span></a>
      <a href="/feed" style="text-decoration:none;"><span class="label">RSS</span></a>
      <a href="http://twitter.com/kouphax" style="text-decoration:none;"><span class="label">Twitter</span></a>
      <a href="http://github.com/kouphax" style="text-decoration:none;"><span class="label">Github</span></a>
    </span>
    
      <h1 class="entry-title">Unobtrusive JavaScript in MVC3</h1>
    

    
      <p class="meta">
        
          <span class="label" style="margin-right:10px;"><a href="/" style="text-decoration:none; text-transform:none; color:#fff">&larr;</a></span>
         
        








  


<time datetime="2010-10-23T00:00:00+01:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content">  <p><p>One of the &ldquo;it&rsquo;s not new but it&rsquo;s cool&rdquo; features that appeared in the ASP.NET  MVC3 Beta was Unobtrusive JavaScript (well actually Unobtrusive Ajax and an  unobtrusive validation adapter for the jQuery Validation plugin).&nbsp; Before we  dive into how this differs from MVC2 lets talk about JavaScript in MVC.</p><p>First things first&nbsp;&ndash; jQuery is now the defacto standard for any ASP.NET MVC  solution.&nbsp; In the MVC2 Project Template you got both the Microsoft Ajax Library  and jQuery.&nbsp; This hasn&rsquo;t changed in MVC3 but the Microsoft stuff is only there  for any potential backward compatibility issues a solution&nbsp;may have&nbsp;&ndash; feel free  to just delete these files and embrace jQuery.&nbsp; All the new client side stuff is  all facilitated through jQuery which means you wont have to have some other  framework on your page just because generated code mandates it.</p><h2>What Is It?</h2><p>Unobtrusive JavaScript (in the MVC3 sense) is a strategy that ensures that no  JavaScript is embedded within the markup (unless you do it yourself).&nbsp; 100% no  generated code muddying your markup.&nbsp; No code islands,&nbsp;no inline event handlers,  better handling of failure&nbsp;cases&nbsp;and no dependence on any specific framework.&nbsp;  To me, being a web focused developer, this is HUGE and it should be to you too&nbsp;&ndash;  it is after all considered best practise.</p><h2>Turn It On</h2><p>There are two ways to turn Unobtrusive Ajax/Validation on,</p><h3>1. Web.Config</h3><p>Within the &lt;appSettings&gt; config node in Web.Config you can specify  whether unobtrusive JavaScript is on or off</p><p><script src="https://gist.github.com/642655.js"></script></p><h3>2 On a Per-Page Basis</h3><p>Just like EnableClientValidation it is possible to activate unobtrusive  JavaScript&nbsp; at a page level.</p><p><script src="https://gist.github.com/642657.js"></script></p><h2>What Does It Do</h2><p>Best way to show what it does is by comparison to, um,&nbsp;Obtrusive JavaScript.&nbsp;  So lets create a scenario in both MVC2 and MVC3 and seeing how they compare.&nbsp;  The scenario will be a simple ajaxified login form (Username and Password) with  some client validation and no server side magic.&nbsp; Most of this, bar the client  side scripts, is the same across both solutions.&nbsp;</p><h2>The Model</h2><p><script src="https://gist.github.com/642569.js"></script></p><p>Two properties with basic [Required] validation.&nbsp;</p><h2>The Controller</h2><p><script src="https://gist.github.com/642572.js"></script></p><p>Again there isn&rsquo;t much going on here, this all about the client side!</p><h2>The View</h2><h3>Common Parts</h3><p><script src="https://gist.github.com/642578.js"></script></p><p>A simple view that is the same across both projects the only thing that is  going to differ is the actual libraries/scripts that do all the wiring up.&nbsp;</p><h3>MVC2</h3><p><script src="https://gist.github.com/642584.js"></script></p><p>Using the out of the box Microsoft Ajax Library (which is now deprecated)</p><h3>MVC3</h3><p><script src="https://gist.github.com/642585.js"></script></p><p>Using the out of the box jQuery plugins.</p><p>Done.&nbsp; That&rsquo;s all we need for our solutions to function.&nbsp; The form will be  validated on the client side and&nbsp;submission will be&nbsp;performed through ajax.&nbsp;  Both will behave exactly the same but the markup and code they generate will be  quite different.&nbsp; I&rsquo;ve tidied both up in terms of formatting just so it&rsquo;s  slightly easier to read but I&rsquo;ve tried to keep the layout style consistent  across both.</p><h2>MVC2 Output</h2><p><script src="https://gist.github.com/642592.js"></script></p><h2>MVC 3 Output</h2><p><script src="https://gist.github.com/642599.js"></script></p><h2>Analysis</h2><p>The first obvious thing we can see is that the&nbsp;UnobJS code is slightly  lighter, even with strict formatting turned it generally produces less LOC&rsquo;s.&nbsp;  But that&rsquo;s not really that important in the grand scheme of things, but is  important is the whole unobtrusiveness of the UnobJS source.</p><p>In the old MVC2 code look at those inline event handlers at lines 14 and 15,  look at that huge code island at line 33, smack bang in the middle of our HTML.&nbsp;  It&rsquo;s not wrong per say but it&rsquo;s certainly not best practise.&nbsp; No it&rsquo;s always  best to keep your View (HTML) and your Code (JavaScript) separated as much as  possible.&nbsp; Imagine if some wayward script was added between line 61 and 62 did  something like this</p><p><script src="https://gist.github.com/642614.js"></script></p><p>OHT3HNOES END OF THE WORLD!</p><p>Or what if your CDN that served your scripts was down?&nbsp; You are actually  going to get JavaScript errors during form submission which can, in various  browsers, prevent the form being submitted.</p><p>OHT3HNOES&nbsp;END OF THE WORLD AGAIN!</p><p>MVC 3/UnobJS on the other hand isn&rsquo;t going to error out and will fall back to  a normal form submission - progressive enhancement or just expected  behaviour?</p><p>On other thing&hellip; those inline event handlers pretty much need to have the MS  Ajax Library available to work (and not&nbsp;cause errors).&nbsp; What if I was already  using jQuery for my project?&nbsp; I&rsquo;d still need to include MS Ajax on the page even  though only generated code required it (well I could write my own API mimicking  the required MS Ajax API but why should I?).</p><p>Now Unobtrusive JavaScript isn&rsquo;t without it&rsquo;s issues.&nbsp; Using HTML5&rsquo;s data-  attributes can invalidate your HTML which can be a showstopper for some  projects.&nbsp; One other issue that we may start to see is that EVERYONE is starting  to use data- attributes (e.g. jQuery Mobile) I wonder if we are going to start  seeing collisions between different libraries?</p><p>All in all I don&rsquo;t think there should be an option to turn  Unobtrusive&nbsp;JavaScript off, it should just be the only way of doing things :-)  but thats just me.</p></p></div>


  <footer>
    <p class="meta">
      








  


<time datetime="2010-10-23T00:00:00+01:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2010</time>
      

<span style="float:right">
  
    <a href='/blog/categories/asp-net-mvc/' style='text-decoration:none;'><span class='label label-info'>asp.net mvc</span></a> <a href='/blog/categories/javascript/' style='text-decoration:none;'><span class='label label-info'>javascript</span></a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://yobriefca.se/blog/2010/10/23/unobtrusive-javascript-in-mvc3/" data-via="kouphax" data-counturl="http://yobriefca.se/blog/2010/10/23/unobtrusive-javascript-in-mvc3/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>
    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2010/10/22/practical-jquery-mobile-with-asp-net-mvc/" title="Previous Post: Practical jQuery Mobile with ASP.NET MVC">&laquo; Practical jQuery Mobile with ASP.NET MVC</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/10/24/validateinputattribute-changes-in-mvc3-beta-2-/" title="next Post: ValidateInputAttribute Changes in MVC3 (Beta 2)">ValidateInputAttribute Changes in MVC3 (Beta 2) &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <script>var dis_inpost = true;</script>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

    </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'kouphax';
      
        
        if(window.dis_inpost){
          var disqus_identifier = 'http://yobriefca.se/blog/2010/10/23/unobtrusive-javascript-in-mvc3/';
          var disqus_url = 'http://yobriefca.se/blog/2010/10/23/unobtrusive-javascript-in-mvc3/';
          var disqus_script = 'embed.js';
        }else{
          var disqus_script = 'count.js';
        }

      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
