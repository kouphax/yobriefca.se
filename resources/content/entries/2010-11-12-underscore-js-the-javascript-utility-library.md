---
date: 2010-11-12T00:00:00Z
title: 'Underscore.js: The JavaScript Utility Library'
published: true
categories: [JavaScript]
type: article
external: false
---
<p class="img-holder"><img alt="" src="http://farm5.static.flickr.com/4017/5168979559_07b681c56d_o.gif" /></p><p>I've been meaning to give <a href="http://documentcloud.github.com/underscore/">Underscore.js</a> some love  for some time but never got around to it.  The other day I though about writing  about <a href="http://documentcloud.github.com/backbone/">Backbone.js</a> (another excellent library from the <a href="http://www.documentcloud.org/home">same people</a>) but didn't feel it  was possible to do so without first talking about Underscore as it underpins  most of the Backbone.js functionality.  So without further ado...</p><h2>Introduction</h2><p style="padding-left: 30px;"><em><a href="http://github.com/documentcloud/underscore/">Underscore</a> is a  utility-belt library for JavaScript that provides a lot of the functional  programming support that you would expect in <a href="http://prototypejs.org/api">Prototype.js</a> (or <a href="http://www.ruby-doc.org/core/classes/Enumerable.html">Ruby</a>), but  without extending any of the built-in JavaScript objects. It's the tie to go  along with <a href="http://docs.jquery.com/">jQuery</a>'s tux.</em></p><p style="text-align: right;">- <a href="http://documentcloud.github.com/underscore/">http://documentcloud.github.com/underscore/</a></p><p>That's how the creators describe underscore and it's pretty spot  on.  Underscore offers numerous low level functions that can be used to  perform on arrays and collections (as well as few for object and functions).   Some of these functions are available in some browsers but not all and because  of this Underscore provides a nice layer of abstraction to avoid having to  constantly feature detect.  Incidentally where a browser does implement a  specific function Underscore will always fallback on the native implementation  ensuring that performance is as optimal as possible.  This is the sort of stuff  that you would probably miss if you moved from <a href="http://www.prototypejs.org/">Prototype</a> to <a href="http://www.jquery.com/">jQuery</a>.  Another point to note is that  Underscore doesn't extend native objects with it's own implementations which  most people will consider a good thing.  Instead, like jQuery, Underscore  exposes a single global object aptly named _.  Now I am not 100% sold on this, I  am a bit strange when it comes to neat code and I think this variable name makes  code look a bit "noisy".  Not a big deal but I like to pick holes in things  :-).</p><h2>Coding Styles</h2><p>There are two ways to write code using Underscore.  Imagine the scenario that  given an array of numbers You can go the functional route and call methods  directly on the underscore object,</p><p></p><div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">filtered</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">select</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">v</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">;</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">filtered</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">memo</span><span class="p">,</span> <span class="nx">v</span><span class="p">){</span> 
    <span class="k">return</span> <span class="nx">memo</span> <span class="o">+</span> <span class="nx">v</span><span class="p">;</span> 
<span class="p">},</span> <span class="mi">0</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sum</span><span class="p">)</span>
<span class="c1">// =&gt; 101</span>
</code></pre></div>
<p>Or go the OO route for those familiar with the jQuery style syntax, </p><p><div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">23</span><span class="p">]).</span><span class="nx">chain</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">){</span> <span class="k">return</span> <span class="nx">v</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">;</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">memo</span><span class="p">,</span> <span class="nx">v</span><span class="p">){</span> <span class="k">return</span> <span class="nx">memo</span> <span class="o">+</span> <span class="nx">v</span><span class="p">;</span> <span class="p">},</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">value</span><span class="p">();</span>
    
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sum</span><span class="p">)</span>
<span class="c1">// =&gt; 101    </span>
</code></pre></div>
</p><p>These 2 examples acheive the same thing - filter a list to those  values greater than 10 and derive a sum of these values; but the look and feel  are actually quite different.  Which one you chose will be down to personal  preference (I tend towards the former approach but the jury is still out).</p><h2>Collections/Arrays</h2><p>Underscore has a ton of collection and array methods -  a  collection being either an array or an object (as in an object is essentially a  property bag/associative array). </p><p>The usual suspects for array manipulation/traversal are all here.  Coming  from a C# background some of the names will be familiar and some are different  but they achieve the same thing - here is just a tiny subset,</p><h3>each()</h3><p>Loops over a collection executing a callback on each element.  break; support  provided by _.breakLoop()</p><p></p><div class="highlight"><pre><code><span class="nx">_</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">17</span><span class="p">]).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">isPrime</span><span class="p">(</span><span class="nx">num</span><span class="p">)){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"First prime: "</span><span class="p">,</span> <span class="nx">num</span><span class="p">);</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">breakLoop</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="o">=&gt;</span> <span class="nx">First</span> <span class="nx">Prime</span><span class="o">:</span> <span class="mi">11</span>
</code></pre></div>
<h3>map()</h3><p>Creates a new array from a collection where each element can be transformed  by a callback</p><p></p><div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">_</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">17</span><span class="p">]).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">isPrime</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
<span class="c1">//=&gt; [false,false,false,false,true,true,true]</span>
</code></pre></div>
<h3>first()/last()</h3><p>Select the first and last elements from an array</p><p></p><div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">];</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">(</span><span class="nx">arr</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">last</span><span class="p">(</span><span class="nx">arr</span><span class="p">));</span>
<span class="c1">//=&gt; 2</span>
<span class="c1">//=&gt; 4</span>
</code></pre></div>
<h2>Functions</h2><p>Underscore provides a number of methods that can be applied to functions.   These include the ability to bind methods to a specific object/context (bind),  memoize functions (caching or results to increase calculation speeds), delay and  defer execution of methods and perform some AOP style actions on functions (wrap  and compose).</p><h2>Objects</h2><p>Underscore provides a number of common object related methods such as the  ubiquitous extend and clone functions.  Other useful functions include the use  of a tap function.  This function lets you "tap" into an execution chain and  inspect/manipulate the object in its current state.  The underscore example  demonstrates this perfectly.</p><p></p><div class="highlight"><pre><code><span class="nx">_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">200</span><span class="p">]).</span><span class="nx">chain</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">num</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">num</span> <span class="o">*</span> <span class="nx">num</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">value</span><span class="p">();</span>

<span class="c1">//=&gt; [2, 200]</span>
<span class="c1">//=&gt; [4, 40000]</span>
</code></pre></div>
<p>As you can see the tap function is used to push the object (in this case an  array) through.  There is also a fairly robust set of type detection  functions.</p><p style="padding-left: 30px;"><em>isEqual, isEmpty, isElement,isArray, isArguments, isFunction, isString,  isNumber, isBoolean, isDate,isRegExp isNaN, isNull, isUndefined</em></p><h2>Other Things</h2><p>There are a few other specific methods in Underscore that provide utility  functions including,</p><ul><li>template - super simple templating function</li><li>mixin - extend underscores functionlaity with your own custom methods</li><li>times - execute a callback a specified number of times</li></ul><h2>Conclusion</h2><p>This is a very high level overview of Underscore (so I can now go and get all  excited abuot Backbone) but hopefully you can see it's worth.  Have a look at  the <a href="http://documentcloud.github.com/underscore/">comprehensive docs</a> that many of my example where derived from and see if there is anything useful  for you there.</p>