--- 
layout: post
title: "CoffeeScript: JavaScript sans Bad Parts"
published: true
categories: [JavaScript, CoffeeScript]
---
  <blockquote>This was written a long time ago when coffeescript was in early beta and I&rsquo;ve  decided to push it into the public domain.  I&rsquo;ve updated it a bit but I  apologise for any oversights.<p>Also worth mentioning that I am a lot more taken with it than I was at the time of the original blog. &nbsp;I will be revisiting this again soon.</p></blockquote><p>If I&rsquo;ve said it once, I&rsquo;ve said it a million times &ndash; JavaScript is  misunderstood.  Sure it&rsquo;s got it&rsquo;s bad parts (eval, ==, typed wrappers etc.) and  it&rsquo;s got it&rsquo;s VERY bad parts (global variables, scope, typeof etc) but it&rsquo;s also  got a lot of beautiful parts (functions as first class objects, object and array  literals, dynamic objects and prototypal inheritance etc.).  JSLint validates  your code against the good subset to ensure you aren&rsquo;t using all that nasty  stuff that is going to break your code eventually but can we take it a step  further?  What if we could take out the good subset and create a subset of the  language so we couldn&rsquo;t ever use the bad stuff?  Well turns out you can.</p><h2>Enter CoffeeScript</h2><p><a href="http://jashkenas.github.com/coffee-script/">CoffeeScript</a> is a  full featured subset of JavaScript.  Essentially it is a meta-language that  compiles into JavaScript.  Its syntax is a bit different, more like Perl, Python  or Ruby and the JavaScript it generates only uses the &ldquo;good parts&rdquo; of JavaScript  and passes all strict JSLint tests.</p><h3>Syntax</h3><p>CoffeeScripts syntax is close to JavaScript and besides a few extra goodies  it is nearly a 1:1 mapping.  However it strips away a lot of the boilerplate  stuff to make the code you write slightly more succinct.  Another feature of the  syntax is that indentation is important (like Perl or Python, I can never  remember which) as there are no line ending tokens.  So lets look at a few  statements</p><p><span style=""><script src="https://gist.github.com/868206.js"></script></span></p><p>This simple example of variable creation and assignment demonstrates how  CoffeeScripts avoids one of the most common and potentially fatal mistakes made  by many JavaScript developers &ndash; Inadvertent global variable declaration.  In  plain old JavaScript leaving out a var statement on a variable declaration  results in the variable being declared (or overwritten &ndash;eek!) in the global  scope.  In CoffeeScript var is optional and all variable declarations are made  in the current scope (and pushed to the top of the scope as is the JavaScript  way).  Want global scope declaration for some random reason?  Use  window.variable name and then ask yourself why you are doing it wrong.</p><p><span style=""><script src="https://gist.github.com/868210.js"></script></span></p><p><span style=""><a href="http://gist.github.com/868210" title="http://gist.github.com/868210"></a></span><span style=""><script src="https://gist.github.com/868208.js"></script></span></p><p>Function declarations are a good example of how succinct CoffeeScript can be  in comparison to JavaScript.  In fact anyone keen on C#&rsquo;s lambdas or Groovys  syntax will find this quite familiar.  Gone are the bloating function and return  keywords ( &ndash;&gt; is the empty function &ndash; function() {})</p><p><span style=""><script src="https://gist.github.com/868212.js"></script></span></p><p><span style=""><a href="http://gist.github.com/868212" title="http://gist.github.com/868212"></a></span><span style=""><script src="https://gist.github.com/868215.js"></script></span></p><p>Existence is a nice feature as it keeps non-boolean falsy values nice and  strict and saves a lot of guessing.  That&rsquo;s the basics but as I mentioned  earlier there are some nice bonus features that can make some common tasks very  clean.</p><h3><strong>The Goodie Bag</strong></h3><h4>Array Comprehension</h4><h4><span style="font-weight: normal;"><script src="https://gist.github.com/868218.js"></script></span></h4><p>Array comprehension is quite a common task in many JavaScript solutions.   Simply put this is the Map part of any typical MapReduce situations (common in  many NoSQL style databases and Ajax situations).  MapReduce is essentially &ndash;  given an array of items,</p><ul><li>Map: Transform that list into what you want (SQLs SELECT) </li><li>Reduce: Based on that mapping remove unwanted items</li></ul><p>In the Ajax world you&rsquo;d probably need to do this when dealing with JSON or  XML responses which are quite often generally result sets.  The example above  shows just how easy it is to apply an arbitrary function over an array of  items.  Now I guess the equivalent JS could be written slightly better by hand  but would it not take longer and be harder to maintain?  Probably.  This being  quite a common task the less you have to write the better!</p><h4>Splats</h4><p>Splats are a convenient way to work with the arguments object in JavaScript  while clearly outlining required and optional arguments.  Lets take this  example.</p><p><script src="https://gist.github.com/868221.js"></script></p><p>Look familiar to you .NET people?  It should because for all intents and  purposes this is the same as the param keyword.  Implementing this sort of thing  in JavaScript is no easy task.  Again the generated JavaScript could be  simplified if written by a human bean but could you get it right first time  without seeing this generated code?</p><h4>Destructing Assignment</h4><p>Already part of the JavaScript spec but not present in all implementations  (see MDC article) destructing assignments allow the assigning of multiple values  in one fell swoop e.g.</p><p><script src="https://gist.github.com/868224.js"></script></p><p>I&rsquo;ve never really come across a massive need for something like this but I  guess it&rsquo;s another handy tool to have in the scripting world.</p><h3>Should We All Be Using It?</h3><p>If you think I am going to say &ldquo;Yes&rdquo; immediatley you are wrong.  And if you are now  asking yourself why I even bothered typing this&hellip;. lets just say train rides are  boring but not as boring as most of the TV shows my darling wife makes me sit  through EVERY FLIPPING NIGHT OF MY LIFE!!!!</p><p>The big reason I am not recommending it yet is that I am not 100% convinced  of the benefits of using it above plain old JavaScript.  It&rsquo;s a bit like  marmite.  Many node.js developers write in CoffeeScript, and ONLY CoffeeScript  but many still simply reject it.  I can understand both standpoints so until I  can say without faltering that one side has got it right I am not taking it  seriously. &nbsp;That said I prefer to form my own opinions anyway so I need to spend a lot more time with it before I can jump to any conclusions.</p><p>Oh and, honestly, who actually really wants to spend what limited time they  have trying new things, hacking around, experimenting, taking risks, getting  frustrated and making plenty of mistakes?  Anyone? Anyone at all? &nbsp;Nah I didn't think so. &nbsp;Computers are just a 9-5 job for all of us ;-P</p>