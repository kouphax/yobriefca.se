--- 
layout: post
title: Serialising .NET Resources to JSON for Web Apps
published: true
categories: [.NET, JSON]
---
  <p>Pop quiz hotshot &ndash; you are building one of them massive single page web apps  using something like Sencha where the vast majority of work is pushed into the  JavaScript realm and some crazy nut wants everything localised or at least  all text strings push to RESX files.  What do you do?  WHAT DO YOU DO?</p><h2>Option 1</h2><p>Well the most obvious option, and IMHO the most horrible, would be to convert  all those JavaScript files into aspx&rsquo;s or cshtml&rsquo;s or whatever and embed the  resource references directly into the files.</p><p><script src="https://gist.github.com/892038.js"></script></p><p>This is far from nice.  For one it kind of makes any static compression of  the files either impossible or at best annoyingly fiddly.  It also prevents any  sort of quick client side caching unless you use some sort of VaryByCulture  Output Caching strategy on the server side.  Blegh.</p><h2>Option 2</h2><p>The next option, and certainly much better would be to pull out the direct  &lt;%= %&gt; references and store them in another smaller file and reference  them through a global JS object</p><p><script src="https://gist.github.com/892054.js"></script></p><p><script src="https://gist.github.com/892048.js"></script></p><p>This is nicer because it means you can compress and cache the JavaScript file  globally without having to worry about different cultures etc.  It does leave  one annoyance though.  The Strings object above it essentially boiler plate.   The names are a 1:1 mapping of the resource file so we have introduced a layer  of abstraction we have to write manually leaving us open to make some mistakes.   Slightly less blegh, but still blegh.</p><h2>Option 3</h2><p>The solution I like the best is to provide a mechanism for serialising the  Resource file into the equivalent JSON object.  You get all the benefits of  option 2 while not having to worry about having to write the mapping file.  So  lets keep the JS file from the second option and change the ASPX file</p><p><script src="https://gist.github.com/892069.js"></script></p><p>Now lets look at the magic behind this option &ndash; the JSON Serialiser</p><p><script src="https://gist.github.com/891939.js"></script></p><p>Simple enough little class that is configurable by Culture etc. so you can  pull different translation out on demand if needs be.  Obviously it doesn&rsquo;t do  anything around caching - SRP and all that stuff you know :-P</p><p>Yeah so I&rsquo;ve used this on 2 projects already with great success so hopefully  someone else finds it useful.</p>